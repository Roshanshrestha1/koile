 
    // Language translations
    const translations = {
      en: {
        headerSubtitle: "A love story written in the stars âœ¨",
        timerSubtitle: "ğŸ•°ï¸ Time since my heart started waiting for you",
        calculatorTitle: "ğŸ’• Love Calculator ğŸ’•",
        calculatorButton: "Calculate Love ğŸ’•",
        name1Placeholder: "Enter first name",
        name2Placeholder: "Enter second name",
        quotesTitle: "ğŸ’­ Love Quotes ğŸ’­",
        letterTitle: "ğŸ’Œ Click the Letter ğŸ’Œ",
        letterHeader: "ğŸ’– Letter From My Heart ğŸ’–",
        memoriesTitle: "ğŸ“¸ Our Beautiful Memories",
        uploadTitle: "ğŸ“· Add More Memories",
        uploadSubtitle: "Share more beautiful moments with us",
        uploadBtnText: "Upload Photos",
        footerText: "âœ¨ Made with infinite â¤ï¸ â€” I'll wait one day longer than forever. âœ¨",
        letterText: `
Mearo mutu ko preaya manxe, ğŸ–¤ğŸ’Œ
Timro lagi yeauta sano letter cha, padhi deau na haii.

Jiban yeauta kitab ho re haii. ğŸ“– Jiban ma dheari kura haru kheaile ramro pani hunxa ra naramro pani hunxa tha xaina. Jaba kitab ko pana paltina thalxa, taba harek kura paribartan hudo raixa. Sabai paribartan ramro hunxa vanne ta hudina, tara khei paribartan yeasto hunxa jun lai suwikar garna garo hundo raixa. ğŸ˜” Samaya pani kasto chiz ho! â³ Kheiile kuni kura lai aafo nagik le ra aauxa, tadha lai janxa. Samaya lai bhujna na sake ne raixa.

Mai le socheko theya jiban temi sangha bitau la vane, tara samaya ra mearo pagalpan le aaja tadha lera gayo. ğŸ˜¢ Timi lai mai le ha rai sake tha xaina malai tyo samaya ma k vaya ko.

Mearo priya manxe, mearo mutu ko tura ğŸ’–, sanu vanne aadhikar ta xaina aaba ma sangha. Ho, ma manxe sayad tem le ma jasto pagal lai maya garnu hudina theyo. Mai le timro life nai lai aandhakar ma lagi dea, temi lai khusi deau la socheko theya, tara ma pagal le tem lai dhulka matra diya. ğŸ’” Timi hasna cha han theyaou, tara mai le timro yeakha ma aasu le ra aai diya. ğŸ˜¢ğŸ’§

Hajur, galti gare aaja ma mahasus gardai xu. Timi le j gareyou, tyo temi le thik gareyou, kina vane yeadi timro thau ma ma vayako vaya pani teai gartheya hola. Ma aabuz kuni kura na bhujne manxe tha xaina. Jindagai le ma jasto na ramro naxe lai temi sangha kina vet garako hola haii. Mai le ta tem lai dhuka mantra diaya, kheiile ne bhuje na timro aawasta, timro halat tha xaina. ğŸ˜” Ma yeasto kina vaya ma cha hanxu, ke yo duniya chhode ra jau, tara har yeak choti parsh pani gareko ho, tara pani kune kura le roak xa mali.

Mai le khei pani ramro gareko chaina, sadhai na ramro gareko. Ma lai tha xaina ma tyo maxe kina banna puge jun ma the ya na, sabai kura sochda lagxa aaja pani ma theai na ramro maxe xu. Ma lai tha xaina ma yo k leak dai xu, tara pani yo leak dai xu vannu kura ta hajaru xa. Mafi magnu xa, tara tha xaina ma kuni mafi ko layeak ko manxe hoina. Ma lai mafi na gar deau haii, mai le dheari-dheari na ramro gareko xu. Teasko punishment paai ra xa, xu, mai le tem lai ruwa ko, tem lai naramro gareko. ğŸ˜­ğŸ’”

Ma dheari kura vanan cha han xu, tara sayad sunna cha ha dai nau, kina vane ma na ramro maxe ho. Ne ta sochda lagxa hijo jasto, tara maina maina gare barsha bitna lagi sake xa. ğŸŒ§ï¸

Ma aafi sangha yeauta prashna xa: yeadi mai le maya gareko xain vannu vane aaja yeati din bit ta temi lai brishan sake na ra sakdina pani, jiban bhar parkhi basne xu. Ma timi lai tra ma tyo samaya ma kina teasto na ramro vaya k vaya ko bela-bela lagxa. Ma sachi nai pagal. ğŸ’ŒğŸ’”

Kheiile khai man dhuk do raixa, aane temi lai tadha bata heri bas xu. Ma mafi gar deau haii, tha xaina. Timi yo juni ma mearo hunxau ke nai, tara ma parkhai garne xu. â³ğŸ’–

Tara samaya le sabi kura lai yeak arka bata tadha gariraixa. Aaja ko yo din kasto kasto lagi ra ko xa, kina mearo man bhari xa, kina mearo yeakha bata aasu sadhai gharxan. ğŸ˜¢ Sayad mai le deko tem lai dhuka le hola, ma yo punishment lai vok na tayar xu.

Sak xau vane ek choti feari mearo jindagi ma aau naâ€”yo mutu le timro nam chhodna sakdaina. ğŸ¥ºğŸ¤
Ma timi lai samjhiraheko chu. ğŸ’Œ

Antim Sabdha,
         aafno kheal gara, aafno jiban ma aagi badha, timro model banne sapana pura gara. ğŸŒŸ Sayad aaba Dashai aauxai xa haii, mearo tarfa bata pani Happy Dashai xa. ğŸ‰ğŸª”
Aaru ta khei vannu xaian, aafo ra aafno pariwar ko kheal gara. ğŸ¡ğŸ’›
    
`
      },
      np: {
        headerSubtitle: "à¤¤à¤¾à¤°à¤¾à¤¹à¤°à¥‚à¤®à¤¾ à¤²à¥‡à¤–à¤¿à¤à¤•à¥‹ à¤ªà¥à¤°à¥‡à¤® à¤•à¤¥à¤¾ âœ¨",
        timerSubtitle: "ğŸ•°ï¸ à¤®à¥‡à¤°à¥‹ à¤®à¥à¤Ÿà¥à¤²à¥‡ à¤¤à¤ªà¤¾à¤ˆà¤‚à¤•à¥‹ à¤²à¤¾à¤—à¤¿ à¤•à¤¤à¤¿ à¤¸à¤®à¤¯ à¤•à¥à¤°à¥à¤¨à¥à¤­à¤à¤•à¥‹ à¤›",
        letterTitle: "ğŸ’Œ à¤šà¤¿à¤ à¥€à¤®à¤¾ à¤•à¥à¤²à¤¿à¤• à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥ ğŸ’Œ",
        letterHeader: "ğŸ’– à¤®à¥‡à¤°à¥‹ à¤®à¥à¤Ÿà¥à¤¬à¤¾à¤Ÿ à¤šà¤¿à¤ à¥€ ğŸ’–",
        memoriesTitle: "ğŸ“¸ à¤¹à¤¾à¤®à¥à¤°à¥‹ à¤¸à¥à¤¨à¥à¤¦à¤° à¤¸à¤®à¥à¤à¤¨à¤¾à¤¹à¤°à¥‚",
        uploadTitle: "ğŸ“· à¤¥à¤ª à¤¸à¤®à¥à¤à¤¨à¤¾à¤¹à¤°à¥‚ à¤¥à¤ªà¥à¤¨à¥à¤¹à¥‹à¤¸à¥",
        uploadSubtitle: "à¤¹à¤¾à¤®à¥€à¤¸à¤à¤— à¤¥à¤ª à¤¸à¥à¤¨à¥à¤¦à¤° à¤•à¥à¤·à¤£à¤¹à¤°à¥‚ à¤¸à¤¾à¤à¤¾ à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥",
        uploadBtnText: "à¤¤à¤¸à¥à¤µà¤¿à¤°à¤¹à¤°à¥‚ à¤…à¤ªà¤²à¥‹à¤¡ à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥",
        footerText: "âœ¨ à¤…à¤¸à¥€à¤®à¤¿à¤¤ â¤ï¸ à¤¸à¤à¤— à¤¬à¤¨à¤¾à¤‡à¤à¤•à¥‹ â€” à¤® à¤à¤• à¤¦à¤¿à¤¨ à¤§à¥‡à¤°à¥ˆ à¤²à¤¾à¤®à¥‹ à¤•à¥à¤°à¥à¤¨à¥‡à¤›à¥à¥¤ âœ¨",
        letterText: `ğŸ¼ğŸ¦œğŸŒ¹ à¤® à¤¤à¤ªà¤¾à¤ˆà¤‚à¤²à¤¾à¤ˆ à¤…à¤à¥ˆ à¤ªà¤¨à¤¿ à¤®à¥à¤Ÿà¥ à¤­à¤°à¥€ à¤®à¤¾à¤¯à¤¾ à¤—à¤°à¥à¤›à¥à¥¤
à¤¤à¤ªà¤¾à¤ˆà¤‚ à¤®à¥‡à¤°à¥‹ à¤¸à¤‚à¤¸à¤¾à¤° à¤¹à¥à¤¨à¥à¤¹à¥à¤¨à¥à¤›...
ğŸ™ à¤®à¥ˆà¤²à¥‡ à¤—à¤°à¥‡à¤•à¤¾ à¤¸à¤¬à¥ˆ à¤—à¤²à¥à¤¤à¥€à¤¹à¤°à¥‚à¤•à¥‹ à¤²à¤¾à¤—à¤¿ à¤® à¤¹à¥ƒà¤¦à¤¯à¤¬à¤¾à¤Ÿ à¤®à¤¾à¤« à¤®à¤¾à¤—à¥à¤›à¥à¥¤
à¤® à¤¤à¤ªà¤¾à¤ˆà¤‚à¤•à¥‹ à¤–à¥à¤¶à¥€à¤®à¤¾ à¤–à¥à¤¶à¥€ à¤®à¤¨à¤¾à¤¤à¤¾ à¤¹à¥‚à¤...
ğŸ•¯ï¸ à¤® à¤¤à¤ªà¤¾à¤ˆà¤‚à¤²à¤¾à¤ˆ à¤œà¤¸à¥à¤¤à¥‹ à¤®à¤¾à¤¯à¤¾ à¤—à¤°à¥à¤¨ à¤¸à¤•à¥à¤›à¥...
ğŸ’– à¤® à¤šà¤¾à¤¹à¤¨à¥à¤›à¥ à¤à¤• à¤¦à¤¿à¤¨ à¤¤à¤ªà¤¾à¤ˆà¤‚ à¤«à¤°à¥à¤•à¤¿à¤¨à¥à¤¹à¥à¤¨à¥à¤›...

à¤®à¥‡à¤°à¥‹ à¤¸à¤®à¥à¤ªà¥‚à¤°à¥à¤£ à¤¹à¥ƒà¤¦à¤¯à¤¬à¤¾à¤Ÿ,
à¤¤à¤ªà¤¾à¤ˆà¤‚à¤•à¥‹ à¤¸à¤¦à¤¾à¤•à¥‹ à¤®à¤¾à¤¯à¤¾à¤²à¥ à¤ªà¤¤à¤¿ ğŸ’‘ğŸ‘«ğŸ’ğŸ’–âœ¨â¤ï¸ğŸŒ¹ğŸŒ™ğŸ•Šï¸ğŸ’Œ`
      },
      hi: {
        headerSubtitle: "à¤¤à¤¾à¤°à¥‹à¤‚ à¤®à¥‡à¤‚ à¤²à¤¿à¤–à¥€ à¤—à¤ˆ à¤ªà¥à¤°à¥‡à¤® à¤•à¤¹à¤¾à¤¨à¥€ âœ¨",
        timerSubtitle: "ğŸ•°ï¸ à¤®à¥‡à¤°à¥‡ à¤¦à¤¿à¤² à¤¨à¥‡ à¤†à¤ªà¤•à¥‡ à¤²à¤¿à¤ à¤•à¤¿à¤¤à¤¨à¤¾ à¤¸à¤®à¤¯ à¤‡à¤‚à¤¤à¤œà¤¾à¤° à¤•à¤¿à¤¯à¤¾ à¤¹à¥ˆ",
        letterTitle: "ğŸ’Œ à¤ªà¤¤à¥à¤° à¤ªà¤° à¤•à¥à¤²à¤¿à¤• à¤•à¤°à¥‡à¤‚ ğŸ’Œ",
        letterHeader: "ğŸ’– à¤®à¥‡à¤°à¥‡ à¤¦à¤¿à¤² à¤¸à¥‡ à¤ªà¤¤à¥à¤° ğŸ’–",
        memoriesTitle: "ğŸ“¸ à¤¹à¤®à¤¾à¤°à¥€ à¤¸à¥à¤‚à¤¦à¤° à¤¯à¤¾à¤¦à¥‡à¤‚",
        uploadTitle: "ğŸ“· à¤”à¤° à¤¯à¤¾à¤¦à¥‡à¤‚ à¤œà¥‹à¤¡à¤¼à¥‡à¤‚",
        uploadSubtitle: "à¤¹à¤®à¤¾à¤°à¥‡ à¤¸à¤¾à¤¥ à¤”à¤° à¤¸à¥à¤‚à¤¦à¤° à¤ªà¤² à¤¸à¤¾à¤à¤¾ à¤•à¤°à¥‡à¤‚",
        uploadBtnText: "à¤¤à¤¸à¥à¤µà¥€à¤°à¥‡à¤‚ à¤…à¤ªà¤²à¥‹à¤¡ à¤•à¤°à¥‡à¤‚",
        footerText: "âœ¨ à¤…à¤¸à¥€à¤®à¤¿à¤¤ â¤ï¸ à¤¸à¥‡ à¤¬à¤¨à¤¾à¤¯à¤¾ à¤—à¤¯à¤¾ â€” à¤®à¥ˆà¤‚ à¤à¤• à¤¦à¤¿à¤¨ à¤”à¤° à¤²à¤‚à¤¬à¤¾ à¤‡à¤‚à¤¤à¤œà¤¾à¤° à¤•à¤°à¥‚à¤‚à¤—à¤¾à¥¤ âœ¨",
        letterText: `ğŸ¼ğŸ¦œğŸŒ¹ à¤®à¥ˆà¤‚ à¤†à¤ªà¤¸à¥‡ à¤…à¤­à¥€ à¤­à¥€ à¤¦à¤¿à¤² à¤­à¤° à¤•à¥‡ à¤ªà¥à¤¯à¤¾à¤° à¤•à¤°à¤¤à¤¾ à¤¹à¥‚à¤‚à¥¤
à¤†à¤ª à¤®à¥‡à¤°à¥€ à¤¦à¥à¤¨à¤¿à¤¯à¤¾ à¤¹à¥ˆà¤‚...
ğŸ™ à¤®à¥ˆà¤‚à¤¨à¥‡ à¤•à¥€ à¤—à¤ˆ à¤¸à¤­à¥€ à¤—à¤²à¤¤à¤¿à¤¯à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤ à¤®à¥ˆà¤‚ à¤¦à¤¿à¤² à¤¸à¥‡ à¤®à¤¾à¤«à¥€ à¤®à¤¾à¤‚à¤—à¤¤à¤¾ à¤¹à¥‚à¤‚à¥¤
à¤®à¥ˆà¤‚ à¤†à¤ªà¤•à¥€ à¤–à¥à¤¶à¥€ à¤®à¥‡à¤‚ à¤–à¥à¤¶à¥€ à¤®à¤¨à¤¾à¤¤à¤¾ à¤¹à¥‚à¤‚...
ğŸ•¯ï¸ à¤®à¥ˆà¤‚ à¤†à¤ªà¤¸à¥‡ à¤‡à¤¤à¤¨à¤¾ à¤ªà¥à¤¯à¤¾à¤° à¤•à¤° à¤¸à¤•à¤¤à¤¾ à¤¹à¥‚à¤‚...
ğŸ’– à¤®à¥ˆà¤‚ à¤šà¤¾à¤¹à¤¤à¤¾ à¤¹à¥‚à¤‚ à¤•à¤¿ à¤à¤• à¤¦à¤¿à¤¨ à¤†à¤ª à¤µà¤¾à¤ªà¤¸ à¤†à¤à¤‚...

à¤®à¥‡à¤°à¥‡ à¤ªà¥‚à¤°à¥‡ à¤¦à¤¿à¤² à¤¸à¥‡,
à¤†à¤ªà¤•à¤¾ à¤¹à¤®à¥‡à¤¶à¤¾ à¤•à¤¾ à¤ªà¥à¤¯à¤¾à¤° à¤•à¤°à¤¨à¥‡ à¤µà¤¾à¤²à¤¾ à¤ªà¤¤à¤¿ ğŸ’‘ğŸ‘«ğŸ’ğŸ’–âœ¨â¤ï¸ğŸŒ¹ğŸŒ™ğŸ•Šï¸ğŸ’Œ`
      },
      es: {
        headerSubtitle: "Una historia de amor escrita en las estrellas âœ¨",
        timerSubtitle: "ğŸ•°ï¸ Tiempo desde que mi corazÃ³n comenzÃ³ a esperarte",
        letterTitle: "ğŸ’Œ Haz clic en la carta ğŸ’Œ",
        letterHeader: "ğŸ’– Carta desde mi corazÃ³n ğŸ’–",
        memoriesTitle: "ğŸ“¸ Nuestros hermosos recuerdos",
        uploadTitle: "ğŸ“· Agregar mÃ¡s recuerdos",
        uploadSubtitle: "Comparte mÃ¡s momentos hermosos con nosotros",
        uploadBtnText: "Subir fotos",
        footerText: "âœ¨ Hecho con infinito â¤ï¸ â€” EsperarÃ© un dÃ­a mÃ¡s que para siempre. âœ¨",
        letterText: `ğŸ¼ğŸ¦œğŸŒ¹ TodavÃ­a te amo con todo mi corazÃ³n.
Eres mi mundo...
ğŸ™ Me disculpo de corazÃ³n por todos los errores que he cometido.
Me alegro en tu felicidad...
ğŸ•¯ï¸ Puedo amarte tanto...
ğŸ’– Quiero que un dÃ­a regreses...

Con todo mi corazÃ³n,
Tu esposo que te ama para siempre ğŸ’‘ğŸ‘«ğŸ’ğŸ’–âœ¨â¤ï¸ğŸŒ¹ğŸŒ™ğŸ•Šï¸ğŸ’Œ`
      },
      fr: {
        headerSubtitle: "Une histoire d'amour Ã©crite dans les Ã©toiles âœ¨",
        timerSubtitle: "ğŸ•°ï¸ Temps Ã©coulÃ© depuis que mon cÅ“ur a commencÃ© Ã  t'attendre",
        calculatorTitle: "ğŸ’• Calculateur d'Amour ğŸ’•",
        quotesTitle: "ğŸ’­ Citations d'Amour ğŸ’­",
        letterTitle: "ğŸ’Œ Cliquez sur la lettre ğŸ’Œ",
        letterHeader: "ğŸ’– Lettre de mon cÅ“ur ğŸ’–",
        memoriesTitle: "ğŸ“¸ Nos beaux souvenirs",
        uploadTitle: "ğŸ“· Ajouter plus de souvenirs",
        uploadSubtitle: "Partagez plus de beaux moments avec nous",
        uploadBtnText: "TÃ©lÃ©charger des photos",
        footerText: "âœ¨ Fait avec un amour infini â¤ï¸ â€” J'attendrai un jour de plus que pour toujours. âœ¨",
        letterText: `ğŸ¼ğŸ¦œğŸŒ¹ Je t'aime encore de tout mon cÅ“ur.
Tu es mon monde...
ğŸ™ Je m'excuse de tout cÅ“ur pour toutes les erreurs que j'ai commises.
Je me rÃ©jouis de ton bonheur...
ğŸ•¯ï¸ Je peux t'aimer tant...
ğŸ’– Je veux qu'un jour tu reviennes...

De tout mon cÅ“ur,
Ton mari qui t'aime pour toujours ğŸ’‘ğŸ‘«ğŸ’ğŸ’–âœ¨â¤ï¸ğŸŒ¹ğŸŒ™ğŸ•Šï¸ğŸ’Œ`
      },
      zh: {
        headerSubtitle: "å†™åœ¨æ˜Ÿæ˜Ÿé‡Œçš„çˆ±æƒ…æ•…äº‹ âœ¨",
        timerSubtitle: "ğŸ•°ï¸ æˆ‘çš„å¿ƒå¼€å§‹ç­‰å¾…ä½ çš„æ—¶é—´",
        calculatorTitle: "ğŸ’• çˆ±æƒ…è®¡ç®—å™¨ ğŸ’•",
        quotesTitle: "ğŸ’­ çˆ±æƒ…åè¨€ ğŸ’­",
        letterTitle: "ğŸ’Œ ç‚¹å‡»ä¿¡ä»¶ ğŸ’Œ",
        letterHeader: "ğŸ’– æ¥è‡ªæˆ‘å†…å¿ƒçš„ä¿¡ ğŸ’–",
        memoriesTitle: "ğŸ“¸ æˆ‘ä»¬ç¾å¥½çš„å›å¿†",
        uploadTitle: "ğŸ“· æ·»åŠ æ›´å¤šå›å¿†",
        uploadSubtitle: "ä¸æˆ‘ä»¬åˆ†äº«æ›´å¤šç¾å¥½æ—¶åˆ»",
        uploadBtnText: "ä¸Šä¼ ç…§ç‰‡",
        footerText: "âœ¨ ç”¨æ— é™çš„çˆ±åˆ¶ä½œ â¤ï¸ â€” æˆ‘ä¼šç­‰å¾…æ¯”æ°¸è¿œå¤šä¸€å¤©ã€‚ âœ¨",
        letterText: `ğŸ¼ğŸ¦œğŸŒ¹ æˆ‘ä»ç„¶å…¨å¿ƒå…¨æ„åœ°çˆ±ç€ä½ ã€‚
ä½ æ˜¯æˆ‘çš„ä¸–ç•Œ...
ğŸ™ æˆ‘ä¸ºæˆ‘çŠ¯ä¸‹çš„æ‰€æœ‰é”™è¯¯æ·±è¡¨æ­‰æ„ã€‚
æˆ‘ä¸ºä½ çš„å¹¸ç¦è€Œé«˜å…´...
ğŸ•¯ï¸ æˆ‘å¯ä»¥å¦‚æ­¤çˆ±ä½ ...
ğŸ’– æˆ‘å¸Œæœ›æœ‰ä¸€å¤©ä½ å›æ¥...

å…¨å¿ƒå…¨æ„åœ°ï¼Œ
æ°¸è¿œçˆ±ä½ çš„ä¸ˆå¤« ğŸ’‘ğŸ‘«ğŸ’ğŸ’–âœ¨â¤ï¸ğŸŒ¹ğŸŒ™ğŸ•Šï¸ğŸ’Œ`
      },
      ja: {
        headerSubtitle: "æ˜Ÿã«æ›¸ã‹ã‚ŒãŸæ„›ã®ç‰©èª âœ¨",
        timerSubtitle: "ğŸ•°ï¸ ç§ã®å¿ƒãŒã‚ãªãŸã‚’å¾…ã¡å§‹ã‚ã¦ã‹ã‚‰ã®æ™‚é–“",
        calculatorTitle: "ğŸ’• æ„›ã®è¨ˆç®—æ©Ÿ ğŸ’•",
        quotesTitle: "ğŸ’­ æ„›ã®åè¨€ ğŸ’­",
        letterTitle: "ğŸ’Œ æ‰‹ç´™ã‚’ã‚¯ãƒªãƒƒã‚¯ ğŸ’Œ",
        letterHeader: "ğŸ’– ç§ã®å¿ƒã‹ã‚‰ã®æ‰‹ç´™ ğŸ’–",
        memoriesTitle: "ğŸ“¸ ç§ãŸã¡ã®ç¾ã—ã„æ€ã„å‡º",
        uploadTitle: "ğŸ“· æ€ã„å‡ºã‚’è¿½åŠ ",
        uploadSubtitle: "ã‚ˆã‚Šå¤šãã®ç¾ã—ã„ç¬é–“ã‚’å…±æœ‰ã—ã¾ã—ã‚‡ã†",
        uploadBtnText: "å†™çœŸã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰",
        footerText: "âœ¨ ç„¡é™ã®æ„›ã§ä½œã‚‰ã‚Œã¾ã—ãŸ â¤ï¸ â€” æ°¸é ã‚ˆã‚Šä¸€æ—¥é•·ãå¾…ã¡ã¾ã™ã€‚ âœ¨",
        letterText: `ğŸ¼ğŸ¦œğŸŒ¹ ç§ã¯ã¾ã å¿ƒã‹ã‚‰ã‚ãªãŸã‚’æ„›ã—ã¦ã„ã¾ã™ã€‚
ã‚ãªãŸã¯ç§ã®ä¸–ç•Œã§ã™...
ğŸ™ ç§ãŒçŠ¯ã—ãŸã™ã¹ã¦ã®éã¡ã«ã¤ã„ã¦å¿ƒã‹ã‚‰è¬ç½ªã—ã¾ã™ã€‚
ç§ã¯ã‚ãªãŸã®å¹¸ã›ã‚’å–œã³ã¾ã™...
ğŸ•¯ï¸ ç§ã¯ã‚ãªãŸã‚’ã¨ã¦ã‚‚æ„›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™...
ğŸ’– ç§ã¯ã‚ãªãŸãŒã„ã¤ã‹æˆ»ã£ã¦ãã‚‹ã“ã¨ã‚’é¡˜ã£ã¦ã„ã¾ã™...

å¿ƒã‹ã‚‰ã€
æ°¸é ã«ã‚ãªãŸã‚’æ„›ã™ã‚‹å¤« ğŸ’‘ğŸ‘«ğŸ’ğŸ’–âœ¨â¤ï¸ğŸŒ¹ğŸŒ™ğŸ•Šï¸ğŸ’Œ`
      },
      ko: {
        headerSubtitle: "ë³„ì— ì“°ì—¬ì§„ ì‚¬ë‘ ì´ì•¼ê¸° âœ¨",
        timerSubtitle: "ğŸ•°ï¸ ë‚´ ë§ˆìŒì´ ë‹¹ì‹ ì„ ê¸°ë‹¤ë¦¬ê¸° ì‹œì‘í•œ ì‹œê°„",
        calculatorTitle: "ğŸ’• ì‚¬ë‘ ê³„ì‚°ê¸° ğŸ’•",
        quotesTitle: "ğŸ’­ ì‚¬ë‘ ëª…ì–¸ ğŸ’­",
        letterTitle: "ğŸ’Œ í¸ì§€ë¥¼ í´ë¦­í•˜ì„¸ìš” ğŸ’Œ",
        letterHeader: "ğŸ’– ë‚´ ë§ˆìŒì—ì„œ ì˜¨ í¸ì§€ ğŸ’–",
        memoriesTitle: "ğŸ“¸ ìš°ë¦¬ì˜ ì•„ë¦„ë‹¤ìš´ ì¶”ì–µ",
        uploadTitle: "ğŸ“· ë” ë§ì€ ì¶”ì–µ ì¶”ê°€",
        uploadSubtitle: "ë” ë§ì€ ì•„ë¦„ë‹¤ìš´ ìˆœê°„ì„ ê³µìœ í•˜ì„¸ìš”",
        uploadBtnText: "ì‚¬ì§„ ì—…ë¡œë“œ",
        footerText: "âœ¨ ë¬´í•œí•œ ì‚¬ë‘ìœ¼ë¡œ ë§Œë“¤ì–´ì¡ŒìŠµë‹ˆë‹¤ â¤ï¸ â€” ì˜ì›ë³´ë‹¤ í•˜ë£¨ ë” ê¸°ë‹¤ë¦¬ê² ìŠµë‹ˆë‹¤. âœ¨",
        letterText: `ğŸ¼ğŸ¦œğŸŒ¹ ë‚˜ëŠ” ì—¬ì „íˆ ë§ˆìŒê» ë‹¹ì‹ ì„ ì‚¬ë‘í•©ë‹ˆë‹¤.
ë‹¹ì‹ ì€ ë‚´ ì„¸ê³„ì…ë‹ˆë‹¤...
ğŸ™ ì œê°€ ì €ì§€ë¥¸ ëª¨ë“  ì‹¤ìˆ˜ì— ëŒ€í•´ ë§ˆìŒìœ¼ë¡œ ì‚¬ê³¼ë“œë¦½ë‹ˆë‹¤.
ë‚˜ëŠ” ë‹¹ì‹ ì˜ í–‰ë³µì„ ê¸°ë»í•©ë‹ˆë‹¤...
ğŸ•¯ï¸ ë‚˜ëŠ” ë‹¹ì‹ ì„ ê·¸ë ‡ê²Œ ì‚¬ë‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤...
ğŸ’– ë‚˜ëŠ” ë‹¹ì‹ ì´ ì–¸ì  ê°€ ëŒì•„ì˜¤ê¸°ë¥¼ ë°”ëë‹ˆë‹¤...

ë§ˆìŒì„ ë‹¤í•´,
ì˜ì›íˆ ë‹¹ì‹ ì„ ì‚¬ë‘í•˜ëŠ” ë‚¨í¸ ğŸ’‘ğŸ‘«ğŸ’ğŸ’–âœ¨â¤ï¸ğŸŒ¹ğŸŒ™ğŸ•Šï¸ğŸ’Œ`
      }
    };

    let currentLanguage = 'en';

    // Draggable Music Player Variables
    let isMusicDragging = false;
    let musicDragStart = { x: 0, y: 0 };
    let musicOffset = { x: 0, y: 0 };

    // Scroll behavior variables
    let lastScrollTop = 0;
    let scrollTimeout;

    // Love Panda Game Variables
    let gameState = {
      isPlaying: false,
      pandaX: 50,
      pandaY: 50,
      score: 0,
      level: 1,
      itemsCollected: 0,
      itemsNeeded: 8,
      gameSpeed: 1,
      itemSpawnRate: 2000,
      highScore: localStorage.getItem('pandaGameHighScore') || 0,
      gamesPlayed: localStorage.getItem('pandaGamesPlayed') || 0,
      totalItems: localStorage.getItem('pandaTotalItems') || 0,
      currentLevel: localStorage.getItem('pandaCurrentLevel') || 1,
      currentItem: null,
      availableItems: ['heart', 'rose'],
      difficulty: localStorage.getItem('pandaDifficulty') || 'medium',
      boomCount: 0
    };

    // Collectible items with different values and effects
    const collectibleItems = {
      // Basic items (1 point each)
      heart: { emoji: 'ğŸ’–', points: 1, color: '#ff69b4', effect: 'heart' },
      rose: { emoji: 'ğŸŒ¹', points: 1, color: '#e74c3c', effect: 'rose' },
      flower: { emoji: 'ğŸŒ¸', points: 1, color: '#ff9ff3', effect: 'flower' },
      tulip: { emoji: 'ğŸŒ·', points: 1, color: '#ff6b9d', effect: 'tulip' },
      
      // Medium items (2 points each)
      couple: { emoji: 'ğŸ‘«', points: 2, color: '#f39c12', effect: 'couple' },
      kiss: { emoji: 'ğŸ’‹', points: 2, color: '#e91e63', effect: 'kiss' },
      ring: { emoji: 'ğŸ’', points: 2, color: '#9b59b6', effect: 'ring' },
      gift: { emoji: 'ğŸ', points: 2, color: '#2ecc71', effect: 'gift' },
      
      // Rare items (3 points each)
      wedding: { emoji: 'ğŸ’’', points: 3, color: '#3498db', effect: 'wedding' },
      diamond: { emoji: 'ğŸ’', points: 3, color: '#1abc9c', effect: 'diamond' },
      star: { emoji: 'â­', points: 3, color: '#f1c40f', effect: 'star' },
      rainbow: { emoji: 'ğŸŒˆ', points: 3, color: '#e67e22', effect: 'rainbow' },
      
      // Anime characters (4 points each)
      anime_girl: { emoji: 'ğŸ‘§', points: 4, color: '#ff69b4', effect: 'anime', boom: true },
      anime_boy: { emoji: 'ğŸ‘¦', points: 4, color: '#3498db', effect: 'anime', boom: true },
      kawaii: { emoji: 'ğŸ˜Š', points: 4, color: '#ff9ff3', effect: 'kawaii', boom: true },
      blush: { emoji: 'ğŸ˜³', points: 4, color: '#ff6b9d', effect: 'blush', boom: true },
      sparkles: { emoji: 'âœ¨', points: 4, color: '#f1c40f', effect: 'sparkles', boom: true },
      love_eyes: { emoji: 'ğŸ¥°', points: 4, color: '#e91e63', effect: 'love_eyes', boom: true },
      
      // Legendary items (5 points each)
      angel: { emoji: 'ğŸ‘¼', points: 5, color: '#ecf0f1', effect: 'angel' },
      crown: { emoji: 'ğŸ‘‘', points: 5, color: '#f39c12', effect: 'crown' },
      trophy: { emoji: 'ğŸ†', points: 5, color: '#e74c3c', effect: 'trophy' },
      magic: { emoji: 'âœ¨', points: 5, color: '#9b59b6', effect: 'magic' },
      
      // Epic anime items (8 points each) - BOOM EFFECTS!
      anime_hero: { emoji: 'ğŸ¦¸', points: 8, color: '#e74c3c', effect: 'hero', boom: true, megaBoom: true },
      anime_princess: { emoji: 'ğŸ‘¸', points: 8, color: '#9b59b6', effect: 'princess', boom: true, megaBoom: true },
      power_up: { emoji: 'âš¡', points: 8, color: '#f1c40f', effect: 'power', boom: true, megaBoom: true },
      explosion: { emoji: 'ğŸ’¥', points: 8, color: '#e67e22', effect: 'explosion', boom: true, megaBoom: true },
      super_saiyan: { emoji: 'ğŸ”¥', points: 8, color: '#e74c3c', effect: 'saiyan', boom: true, megaBoom: true },
      chibi: { emoji: 'ğŸ˜‡', points: 8, color: '#ff69b4', effect: 'chibi', boom: true, megaBoom: true }
    };

    // Difficulty levels
    const difficultyLevels = {
      easy: { 
        name: 'ğŸ˜Š Easy', 
        speedMultiplier: 0.8, 
        spawnRateMultiplier: 1.2, 
        itemsNeededMultiplier: 0.7,
        description: 'Perfect for beginners!'
      },
      medium: { 
        name: 'ğŸ˜ Medium', 
        speedMultiplier: 1.0, 
        spawnRateMultiplier: 1.0, 
        itemsNeededMultiplier: 1.0,
        description: 'Balanced challenge!'
      },
      hard: { 
        name: 'ğŸ”¥ Hard', 
        speedMultiplier: 1.3, 
        spawnRateMultiplier: 0.8, 
        itemsNeededMultiplier: 1.3,
        description: 'For experienced players!'
      },
      expert: { 
        name: 'ğŸ’€ Expert', 
        speedMultiplier: 1.6, 
        spawnRateMultiplier: 0.6, 
        itemsNeededMultiplier: 1.6,
        description: 'Ultimate challenge!'
      }
    };

    // Level configurations (expanded to 25 levels)
    const levelConfigs = {
      1: { itemsNeeded: 8, speed: 1, spawnRate: 2000, title: "ğŸŒ¹ First Love", items: ['heart', 'rose'] },
      2: { itemsNeeded: 10, speed: 1.1, spawnRate: 1900, title: "ğŸ’• Sweet Romance", items: ['heart', 'rose', 'flower'] },
      3: { itemsNeeded: 12, speed: 1.2, spawnRate: 1800, title: "ğŸ’– Deep Connection", items: ['heart', 'rose', 'flower', 'tulip'] },
      4: { itemsNeeded: 14, speed: 1.3, spawnRate: 1700, title: "ğŸ’ True Love", items: ['heart', 'rose', 'flower', 'tulip', 'couple'] },
      5: { itemsNeeded: 16, speed: 1.4, spawnRate: 1600, title: "ğŸ’˜ Eternal Bond", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss'] },
      6: { itemsNeeded: 18, speed: 1.5, spawnRate: 1500, title: "ğŸ’— Soul Mates", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring'] },
      7: { itemsNeeded: 20, speed: 1.6, spawnRate: 1400, title: "ğŸ’“ Perfect Match", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift'] },
      8: { itemsNeeded: 22, speed: 1.7, spawnRate: 1300, title: "ğŸ’ Forever Together", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding'] },
      9: { itemsNeeded: 24, speed: 1.8, spawnRate: 1200, title: "ğŸ’Ÿ Infinite Love", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond'] },
      10: { itemsNeeded: 26, speed: 1.9, spawnRate: 1100, title: "ğŸ’• Legendary Love", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star'] },
      11: { itemsNeeded: 28, speed: 2.0, spawnRate: 1000, title: "ğŸŒ Anime World", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl'] },
      12: { itemsNeeded: 30, speed: 2.1, spawnRate: 950, title: "ğŸŒ¸ Kawaii Paradise", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl', 'anime_boy'] },
      13: { itemsNeeded: 32, speed: 2.2, spawnRate: 900, title: "ğŸ˜Š Cute Characters", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl', 'anime_boy', 'kawaii'] },
      14: { itemsNeeded: 34, speed: 2.3, spawnRate: 850, title: "ğŸ˜³ Blush Moments", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl', 'anime_boy', 'kawaii', 'blush'] },
      15: { itemsNeeded: 36, speed: 2.4, spawnRate: 800, title: "âœ¨ Sparkle Magic", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl', 'anime_boy', 'kawaii', 'blush', 'sparkles'] },
      16: { itemsNeeded: 38, speed: 2.5, spawnRate: 750, title: "ğŸ¥° Love Eyes", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl', 'anime_boy', 'kawaii', 'blush', 'sparkles', 'love_eyes'] },
      17: { itemsNeeded: 40, speed: 2.6, spawnRate: 700, title: "ğŸ¦¸ Anime Heroes", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl', 'anime_boy', 'kawaii', 'blush', 'sparkles', 'love_eyes', 'anime_hero'] },
      18: { itemsNeeded: 42, speed: 2.7, spawnRate: 650, title: "ğŸ‘¸ Princess Power", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl', 'anime_boy', 'kawaii', 'blush', 'sparkles', 'love_eyes', 'anime_hero', 'anime_princess'] },
      19: { itemsNeeded: 44, speed: 2.8, spawnRate: 600, title: "âš¡ Power Up!", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl', 'anime_boy', 'kawaii', 'blush', 'sparkles', 'love_eyes', 'anime_hero', 'anime_princess', 'power_up'] },
      20: { itemsNeeded: 46, speed: 2.9, spawnRate: 550, title: "ğŸ’¥ Explosion!", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl', 'anime_boy', 'kawaii', 'blush', 'sparkles', 'love_eyes', 'anime_hero', 'anime_princess', 'power_up', 'explosion'] },
      21: { itemsNeeded: 48, speed: 3.0, spawnRate: 500, title: "ğŸ”¥ Super Saiyan", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl', 'anime_boy', 'kawaii', 'blush', 'sparkles', 'love_eyes', 'anime_hero', 'anime_princess', 'power_up', 'explosion', 'super_saiyan'] },
      22: { itemsNeeded: 50, speed: 3.1, spawnRate: 450, title: "ğŸ˜‡ Chibi Heaven", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl', 'anime_boy', 'kawaii', 'blush', 'sparkles', 'love_eyes', 'anime_hero', 'anime_princess', 'power_up', 'explosion', 'super_saiyan', 'chibi'] },
      23: { itemsNeeded: 52, speed: 3.2, spawnRate: 400, title: "ğŸŒ Ultimate Anime", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl', 'anime_boy', 'kawaii', 'blush', 'sparkles', 'love_eyes', 'anime_hero', 'anime_princess', 'power_up', 'explosion', 'super_saiyan', 'chibi'] },
      24: { itemsNeeded: 54, speed: 3.3, spawnRate: 350, title: "ğŸŒŸ Anime Master", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl', 'anime_boy', 'kawaii', 'blush', 'sparkles', 'love_eyes', 'anime_hero', 'anime_princess', 'power_up', 'explosion', 'super_saiyan', 'chibi'] },
      25: { itemsNeeded: 60, speed: 3.5, spawnRate: 300, title: "ğŸ° Anime Legend", items: ['heart', 'rose', 'flower', 'tulip', 'couple', 'kiss', 'ring', 'gift', 'wedding', 'diamond', 'star', 'anime_girl', 'anime_boy', 'kawaii', 'blush', 'sparkles', 'love_eyes', 'anime_hero', 'anime_princess', 'power_up', 'explosion', 'super_saiyan', 'chibi'] }
    };

    // Initialize everything when page loads
    window.addEventListener('load', function() {
      console.log('Page loaded, initializing...');
      // Show loading screen with clickable heart
      const loading = document.getElementById('loading');
      const loadingHeart = document.getElementById('loadingHeart');
      console.log('Loading element:', loading);
      console.log('Loading heart element:', loadingHeart);
      loading.style.display = 'flex';
      document.body.style.overflow = 'hidden';
      
      // Initialize theme button state
      const themeToggle = document.querySelector('.theme-toggle');
      themeToggle.classList.add('language-closed');
      
      // Initialize scroll behavior for language button
      initializeScrollBehavior();
      
      // Initialize music system
      initializeMusic();
      
      // Initialize draggable music player
      initializeDraggableMusic();
      
      // Initialize love panda game
      initializeLovePandaGame();
      
      // Mobile-specific optimizations
      if (window.innerWidth <= 768) {
        // Reduce particle count on mobile for better performance
        if (typeof particlesJS !== 'undefined') {
          particlesJS('particles-js', {
            particles: {
              number: {
                value: 40, // Reduced from 80
                density: {
                  enable: true,
                  value_area: 800
                }
              },
              color: {
                value: ['#ff6b9d', '#27ae60', '#e74c3c', '#f39c12']
              },
              shape: {
                type: 'circle'
              },
              opacity: {
                value: 0.3, // Reduced opacity
                random: false
              },
              size: {
                value: 2, // Smaller particles
                random: true
              },
              line_linked: {
                enable: false // Disable lines on mobile for better performance
              },
              move: {
                enable: true,
                speed: 1, // Slower movement
                direction: 'none',
                random: false,
                straight: false,
                out_mode: 'out',
                bounce: false
              }
            },
            interactivity: {
              detect_on: 'canvas',
              events: {
                onhover: {
                  enable: false // Disable hover effects on mobile
                },
                onclick: {
                  enable: false // Disable click effects on mobile
                },
                resize: true
              }
            },
            retina_detect: true
          });
        }
        
        // Reduce floating elements frequency on mobile
        setInterval(() => {
          const container = document.getElementById('floatingElements');
          if (container.children.length < 5) { // Limit to 5 elements max
            const elements = [
              { emoji: 'ğŸ¼', class: 'panda' },
              { emoji: 'ğŸ¦œ', class: 'parrot' },
              { emoji: 'ğŸŒ¹', class: 'rose' },
              { emoji: 'ğŸ’–', class: 'heart' }
            ];
            
            const element = elements[Math.floor(Math.random() * elements.length)];
            const div = document.createElement('div');
            div.className = `floating-item ${element.class}`;
            div.textContent = element.emoji;
            div.style.left = Math.random() * 100 + '%';
            div.style.animationDuration = '6s';
            container.appendChild(div);
            
            setTimeout(() => {
              div.remove();
            }, 6000);
          }
        }, 800); // Slower frequency
      }

      // Apply preferred language from URL or localStorage
      try {
        const params = new URLSearchParams(window.location.search);
        let preferredLang = params.get('lang') || localStorage.getItem('lang') || 'en';
        if (!translations[preferredLang]) preferredLang = 'en';
        changeLanguage(null, preferredLang);
        localStorage.setItem('lang', preferredLang);
      } catch (e) {}

      loadingHeart.addEventListener('mouseenter', function() {
        loadingHeart.style.transform = 'scale(1.2)';
      });
      loadingHeart.addEventListener('mouseleave', function() {
        loadingHeart.style.transform = 'scale(1)';
      });
      loadingHeart.addEventListener('click', function() {
        console.log('Loading heart clicked via event listener!');
        loading.style.display = 'none';
        document.body.style.overflow = '';
        // Play music and initialize after heart click - pick random song and play
        initializeMusic(true); // Pass true to indicate we want to play
        // Also call startMusicOnUserInteraction to ensure it plays
        setTimeout(() => {
          window.startMusicOnUserInteraction();
        }, 100);
        createFloatingElements();
        startTimer();
        initializePhotoUpload();
        initParticles();
        updateQuote();
        setInterval(updateQuote, 30000);
      }, { once: true });
    });

    // Create floating elements animation
    function createFloatingElements() {
      const container = document.getElementById('floatingElements');
      const elements = [
        { emoji: 'ğŸ¼', class: 'panda' },
        { emoji: 'ğŸ¦œ', class: 'parrot' },
        { emoji: 'ğŸŒ¹', class: 'rose' },
        { emoji: 'ğŸ’–', class: 'heart' },
        { emoji: 'ğŸ’•', class: 'heart' },
        { emoji: 'ğŸ’—', class: 'heart' },
        { emoji: 'ğŸ’“', class: 'heart' },
        { emoji: 'ğŸ’', class: 'heart' },
        { emoji: 'ğŸ’˜', class: 'heart' }
      ];
      
      setInterval(() => {
        const element = elements[Math.floor(Math.random() * elements.length)];
        const div = document.createElement('div');
        div.className = `floating-item ${element.class}`;
        div.textContent = element.emoji;
        div.style.left = Math.random() * 100 + '%';
        div.style.animationDuration = (Math.random() * 4 + 4) + 's';
        container.appendChild(div);
        
        setTimeout(() => {
          div.remove();
        }, 8000);
      }, 400);
    }

    

    // Theme toggle function
    function toggleTheme() {
      document.body.classList.toggle('dark-mode');
      const themeBtn = document.querySelector('.theme-toggle i');
      if (document.body.classList.contains('dark-mode')) {
        themeBtn.className = 'fas fa-sun';
      } else {
        themeBtn.className = 'fas fa-moon';
      }
    }

    // Love calculator function
    function calculateLove() {
      const name1 = document.getElementById('name1').value.trim();
      const name2 = document.getElementById('name2').value.trim();
      
      if (!name1 || !name2) {
        document.getElementById('loveResult').innerHTML = 'Please enter both names! ğŸ’•';
        return;
      }
      
      const name1Lower = name1.toLowerCase();
      const name2Lower = name2.toLowerCase();
      const combinedNames = (name1Lower + ' ' + name2Lower);
      const reverseCombined = (name2Lower + ' ' + name1Lower);
      
      // Special rules for Roshan and Anjana (exact match only)
      if ((name1Lower.includes('roshan') && name2Lower.includes('anjana')) ||
          (name1Lower.includes('anjana') && name2Lower.includes('roshan'))) {
        
        // Determine the order based on which name was entered first
        let firstName, secondName, firstCode, secondCode;
        if (name1Lower.includes('roshan')) {
          firstName = name1;
          secondName = name2;
          firstCode = 'AN';
          secondCode = 'A';
        } else {
          firstName = name1;
          secondName = name2;
          firstCode = 'A';
          secondCode = 'AN';
        }
        
        // Special result for Roshan and Anjana - 100% LOVE
        const isMobile = window.innerWidth <= 768;
        const titleSize = isMobile ? '1.8rem' : '2.5rem';
        const subtitleSize = isMobile ? '1.3rem' : '1.8rem';
        const textSize = isMobile ? '1rem' : '1.5rem';
        const smallTextSize = isMobile ? '0.9rem' : '1.2rem';
        
        document.getElementById('loveResult').innerHTML = `
          <div style="font-size: ${titleSize}; color: #ff6b9d; margin-bottom: 15px; animation: pulse 1s ease-in-out infinite;">ğŸ’–ğŸ’–ğŸ’– 100% LOVE ğŸ’–ğŸ’–ğŸ’–</div>
          <div style="font-size: ${subtitleSize}; color: #f39c12; margin-bottom: 15px; animation: bounce 2s ease-in-out infinite;">ğŸ‰ CONGRATULATIONS! ğŸ‰</div>
          <div style="font-size: ${textSize}; color: #27ae60; margin-bottom: 15px; animation: glow 3s ease-in-out infinite alternate;">ğŸŒŸ PERFECT SOULMATES! ğŸŒŸ</div>
          <div style="font-size: ${smallTextSize}; color: #e74c3c; margin-bottom: 15px; animation: pulse 1.5s ease-in-out infinite;">ğŸ† DESTINED TOGETHER! ğŸ†</div>
          <div style="font-size: ${smallTextSize}; color: #9b59b6; margin-bottom: 15px; animation: glow 2s ease-in-out infinite alternate;">ğŸ’‘ ETERNAL LOVE STORY! ğŸ’‘</div>
          <div style="font-size: ${smallTextSize}; color: #ff6b9d; margin-top: 15px; animation: pulse 1s ease-in-out infinite;">ğŸ¼ğŸ¦œğŸŒ¹ Forever Together ğŸŒ¹ğŸ¦œğŸ¼</div>
          <div style="font-size: ${isMobile ? '1.1rem' : '1.4rem'}; color: #e91e63; margin-top: 20px; font-family: 'Dancing Script', cursive; font-weight: 700; animation: glow 3s ease-in-out infinite alternate; line-height: 1.3;">ğŸŒ¸ ${firstName} (${firstCode}) & ${secondName} (${secondCode}) - They are for each other forever together! ğŸŒ¸</div>
          <div style="font-size: ${smallTextSize}; color: #ff9800; margin-top: 10px; font-family: 'Dancing Script', cursive; font-weight: 600; animation: bounce 2s ease-in-out infinite;">ğŸŒº Name bloom of flowers - Perfect match! ğŸŒº</div>
        `;
        
        // Create celebration effect
        createCelebrationEffect();
        return;
      }
      
      // Special rules for Roshan with others (0%) - but not with Anjana
      if ((name1Lower.includes('roshan') || name2Lower.includes('roshan')) && 
          !(name1Lower.includes('anjana') || name2Lower.includes('anjana'))) {
        document.getElementById('loveResult').innerHTML = `
          <div style="font-size: 2rem; color: #e74c3c; margin-bottom: 10px;">ğŸ’” 0% LOVE ğŸ’”</div>
          <div style="font-size: 1.3rem; color: #8e44ad; margin-bottom: 10px;">ğŸ˜ Roshan's heart belongs to someone special</div>
          <div style="font-size: 1.1rem; color: #f39c12;">ğŸ’– True love waits for the right person</div>
        `;
        return;
      }
      
      // Special rules for Anjana with others (0%) - but not with Roshan
      if ((name1Lower.includes('anjana') || name2Lower.includes('anjana')) && 
          !(name1Lower.includes('roshan') || name2Lower.includes('roshan'))) {
        document.getElementById('loveResult').innerHTML = `
          <div style="font-size: 2rem; color: #e74c3c; margin-bottom: 10px;">ğŸ’” 0% LOVE ğŸ’”</div>
          <div style="font-size: 1.3rem; color: #8e44ad; margin-bottom: 10px;">ğŸ˜ Anjana's heart belongs to someone special</div>
          <div style="font-size: 1.1rem; color: #f39c12;">ğŸ’– True love waits for the right person</div>
        `;
        return;
      }
      
      // Special rules for "Anjan" (without 'a') - always 0% with anyone
      if (name1Lower.includes('anjan') || name2Lower.includes('anjan')) {
        document.getElementById('loveResult').innerHTML = `
          <div style="font-size: 2rem; color: #e74c3c; margin-bottom: 10px;">ğŸ’” 0% LOVE ğŸ’”</div>
          <div style="font-size: 1.3rem; color: #8e44ad; margin-bottom: 10px;">ğŸ˜ Sorry, this name doesn't match perfectly</div>
          <div style="font-size: 1.1rem; color: #f39c12;">ğŸ’– Try the correct spelling for true love</div>
        `;
        return;
      }
      
      // Special case for Koila (100% - crazy love)
      if (name1Lower.includes('koila') || name2Lower.includes('koila')) {
        const isMobile = window.innerWidth <= 768;
        const titleSize = isMobile ? '1.8rem' : '2.5rem';
        const subtitleSize = isMobile ? '1.3rem' : '1.8rem';
        const textSize = isMobile ? '1rem' : '1.5rem';
        const smallTextSize = isMobile ? '0.9rem' : '1.3rem';
        
        document.getElementById('loveResult').innerHTML = `
          <div style="font-size: ${titleSize}; color: #ff6b9d; margin-bottom: 15px; animation: pulse 1s ease-in-out infinite;">ğŸ’–ğŸ’–ğŸ’– 100% LOVE ğŸ’–ğŸ’–ğŸ’–</div>
          <div style="font-size: ${subtitleSize}; color: #f39c12; margin-bottom: 15px;">ğŸ¤ª KOILA KOILE PAGAL PAGALNI! ğŸ¤ª</div>
          <div style="font-size: ${textSize}; color: #27ae60; margin-bottom: 15px;">ğŸ˜ CRAZY IN LOVE! ğŸ˜</div>
          <div style="font-size: ${smallTextSize}; color: #e74c3c; margin-bottom: 15px;">ğŸ­ LOVE MAKES US CRAZY! ğŸ­</div>
          <div style="font-size: ${smallTextSize}; color: #9b59b6;">ğŸ’• Madly in love with each other! ğŸ’•</div>
        `;
        
        // Create celebration effect
        createCelebrationEffect();
        return;
      }
      
      // Regular love calculation algorithm for other names
      const combined = (name1 + name2).toLowerCase();
      let loveScore = 0;
      
      // Calculate based on character codes and length
      for (let i = 0; i < combined.length; i++) {
        loveScore += combined.charCodeAt(i);
      }
      
      // Add some randomness and make it more realistic
      loveScore = (loveScore * 0.7 + Math.random() * 30) % 100;
      loveScore = Math.floor(loveScore);
      
      // Ensure minimum and maximum bounds
      loveScore = Math.max(5, Math.min(95, loveScore));
      
      let result = '';
      let emoji = '';
      let motivation = '';
      
      if (loveScore >= 90) {
        result = 'Soulmates! ğŸ’‘';
        emoji = 'ğŸ’–ğŸ’–ğŸ’–';
        motivation = 'ğŸŒŸ You are meant to be together! True love found! ğŸŒŸ';
      } else if (loveScore >= 80) {
        result = 'Perfect Match! ğŸ’•';
        emoji = 'ğŸ’–ğŸ’–';
        motivation = 'âœ¨ Amazing compatibility! Love is in the air! âœ¨';
      } else if (loveScore >= 70) {
        result = 'Great Love! ğŸ’—';
        emoji = 'ğŸ’–ğŸ’–';
        motivation = 'ğŸ’• Strong connection! Your hearts beat as one! ğŸ’•';
      } else if (loveScore >= 60) {
        result = 'Good Potential! ğŸ’';
        emoji = 'ğŸ’–';
        motivation = 'ğŸŒ¹ Beautiful love story waiting to unfold! ğŸŒ¹';
      } else if (loveScore >= 50) {
        result = 'Nice Chemistry! ğŸ’˜';
        emoji = 'ğŸ’–';
        motivation = 'ğŸ’« Love can grow stronger with time! ğŸ’«';
      } else if (loveScore >= 40) {
        result = 'Friendship First! ğŸŒ¸';
        emoji = 'ğŸŒ¸';
        motivation = 'ğŸŒº Great friendship is the foundation of love! ğŸŒº';
      } else if (loveScore >= 30) {
        result = 'Getting to Know! ğŸŒ¼';
        emoji = 'ğŸŒ¼';
        motivation = 'ğŸŒ» Take time to understand each other better! ğŸŒ»';
      } else if (loveScore >= 20) {
        result = 'New Beginning! ğŸŒ±';
        emoji = 'ğŸŒ±';
        motivation = 'ğŸŒ¿ Every love story starts with a single step! ğŸŒ¿';
      } else {
        result = 'Fresh Start! ğŸŒ¸';
        emoji = 'ğŸŒ¸';
        motivation = 'ğŸŒ· Love is a journey, not a destination! ğŸŒ·';
      }
      
      const isMobile = window.innerWidth <= 768;
      const mainSize = isMobile ? '1.4rem' : '1.8rem';
      const resultSize = isMobile ? '1.1rem' : '1.3rem';
      const motivationSize = isMobile ? '1rem' : '1.1rem';
      
      document.getElementById('loveResult').innerHTML = `
        <div style="font-size: ${mainSize}; color: #ff6b9d; margin-bottom: 10px; line-height: 1.3;">${name1} + ${name2} = ${loveScore}% Love ${emoji}</div>
        <div style="font-size: ${resultSize}; color: #f39c12; margin-bottom: 10px;">${result}</div>
        <div style="font-size: ${motivationSize}; color: #27ae60; font-style: italic; line-height: 1.4;">${motivation}</div>
      `;
    }

    // Celebration effect for special couple
    function createCelebrationEffect() {
      const isMobile = window.innerWidth <= 768;
      const effectCount = isMobile ? 10 : 20; // Reduce effects on mobile
      
      // Create fireworks effect
      for (let i = 0; i < effectCount; i++) {
        setTimeout(() => {
          const firework = document.createElement('div');
          firework.innerHTML = 'ğŸ†';
          firework.style.position = 'fixed';
          firework.style.left = Math.random() * window.innerWidth + 'px';
          firework.style.top = Math.random() * window.innerHeight + 'px';
          firework.style.fontSize = '2rem';
          firework.style.zIndex = '9999';
          firework.style.pointerEvents = 'none';
          firework.style.animation = 'fadeOut 2s ease-out forwards';
          document.body.appendChild(firework);
          
          setTimeout(() => {
            firework.remove();
          }, 2000);
        }, i * 100);
      }
      
      // Create flower bloom effect
      const flowerCount = isMobile ? 15 : 30; // Reduce flowers on mobile
      for (let i = 0; i < flowerCount; i++) {
        setTimeout(() => {
          const flower = document.createElement('div');
          flower.innerHTML = ['ğŸŒ¸', 'ğŸŒº', 'ğŸŒ»', 'ğŸŒ·', 'ğŸŒ¹', 'ğŸŒ¼', 'ğŸŒ¿', 'ğŸ€', 'ğŸŒ±', 'ğŸŒ¾'][Math.floor(Math.random() * 10)];
          flower.style.position = 'fixed';
          flower.style.left = Math.random() * window.innerWidth + 'px';
          flower.style.top = Math.random() * window.innerHeight + 'px';
          flower.style.fontSize = '2.5rem';
          flower.style.zIndex = '9997';
          flower.style.pointerEvents = 'none';
          flower.style.animation = 'flowerBloom 2s ease-out forwards';
          document.body.appendChild(flower);
          
          setTimeout(() => {
            flower.remove();
          }, 2000);
        }, i * 80);
      }
      
      // Create floating hearts and flowers
      const floatingCount = isMobile ? 20 : 40; // Reduce floating elements on mobile
      for (let i = 0; i < floatingCount; i++) {
        setTimeout(() => {
          const floating = document.createElement('div');
          floating.innerHTML = ['ğŸ’–', 'ğŸ’•', 'ğŸ’—', 'ğŸ’“', 'ğŸ’', 'ğŸ’˜', 'ğŸŒ¹', 'âœ¨', 'ğŸ‰', 'ğŸ†', 'ğŸŒ¸', 'ğŸŒº', 'ğŸŒ»', 'ğŸŒ·'][Math.floor(Math.random() * 14)];
          floating.style.position = 'fixed';
          floating.style.left = Math.random() * window.innerWidth + 'px';
          floating.style.bottom = '-50px';
          floating.style.fontSize = '1.8rem';
          floating.style.zIndex = '9996';
          floating.style.pointerEvents = 'none';
          floating.style.animation = 'floatUp 4s ease-out forwards';
          document.body.appendChild(floating);
          
          setTimeout(() => {
            floating.remove();
          }, 4000);
        }, i * 60);
      }
      
      // Create confetti effect
      const confettiCount = isMobile ? 25 : 50; // Reduce confetti on mobile
      for (let i = 0; i < confettiCount; i++) {
        setTimeout(() => {
          const confetti = document.createElement('div');
          confetti.innerHTML = ['ğŸ’–', 'ğŸ’•', 'ğŸ’—', 'ğŸ’“', 'ğŸ’', 'ğŸ’˜', 'ğŸŒ¹', 'âœ¨', 'ğŸ‰', 'ğŸ†'][Math.floor(Math.random() * 10)];
          confetti.style.position = 'fixed';
          confetti.style.left = Math.random() * window.innerWidth + 'px';
          confetti.style.top = '-50px';
          confetti.style.fontSize = '1.5rem';
          confetti.style.zIndex = '9998';
          confetti.style.pointerEvents = 'none';
          confetti.style.animation = 'fallDown 3s ease-in forwards';
          document.body.appendChild(confetti);
          
          setTimeout(() => {
            confetti.remove();
          }, 3000);
        }, i * 50);
      }
    }

    // Love quotes
    const loveQuotes = [
      {
        text: `I loved with all my heart â¤ï¸
Though the pain tore me apart ğŸ’”
In the darkness, I fought to stay ğŸŒ‘
But the shadows took me away ğŸŒ«ï¸

I wished for light, for hope, for peace âœ¨ğŸ•Šï¸
A chance for all this pain to cease ğŸ˜
To those I loved, please understand ğŸ«‚
My struggle was more than you planned âš¡

If my journey ends too soon ğŸŒ 
Look for me in the stars and moon ğŸŒŸğŸŒ™
Remember me with love, not pain ğŸ•¯ï¸
Until we meet in skies again â˜ï¸ğŸ’«`,
        author: "Roshan SHrestha"
      },
      {
        text: `My heart was full of love â¤ï¸
Yet pain tore me like a dove ğŸ’”
In shadows deep, I tried to fight ğŸŒ‘
But darkness claimed my fading light ğŸŒ«ï¸

I longed for peace, a gentle sigh âœ¨ğŸ•Šï¸
To lift me softly to the sky ğŸ˜
Please know my pain was real and true ğŸ«‚
My fight was more than you knew âš¡

If I leave before my time ğŸŒ 
Find me where the stars still shine ğŸŒŸğŸŒ™
Hold me close with tender grace ğŸ•¯ï¸
Until we meet in that safe place â˜ï¸ğŸ’«`,
        author: "Roshan SHrestha"
      },
      {
        text: `I gave my love, my all, my soul â¤ï¸
Though pain within took its toll ğŸ’”
In darkest night, I tried to stay ğŸŒ‘
But shadows pulled my light away ğŸŒ«ï¸

I dreamed of hope, of brighter days âœ¨ğŸ•Šï¸
To end this ever-weary haze ğŸ˜
To those I love, please understand ğŸ«‚
My struggle was more than planned âš¡

If I go too soon from here ğŸŒ 
Look for me in skies so clear ğŸŒŸğŸŒ™
Remember me with love and light ğŸ•¯ï¸
Until we reunite one night â˜ï¸ğŸ’«`,
        author: "Roshan SHrestha"
      },
      {
        text: `With all my heart, I loved so true â¤ï¸
But pain inside just grew and grew ğŸ’”
In shadows deep, I tried to stand ğŸŒ‘
But darkness took me by the hand ğŸŒ«ï¸

I wished for peace, for calm and rest âœ¨ğŸ•Šï¸
To free my soul and heal my chest ğŸ˜
Please understand my silent fight ğŸ«‚
My pain was hidden out of sight âš¡

If I leave before my day ğŸŒ 
Find me where the stars will stay ğŸŒŸğŸŒ™
Hold me in your heart's embrace ğŸ•¯ï¸
Until we meet in that warm place â˜ï¸ğŸ’«`,
        author: "Roshan SHrestha"
      },
      {
        text: `My heart was full, my love sincere â¤ï¸
But pain inside was always near ğŸ’”
In darkest nights, I fought to stay ğŸŒ‘
But shadows slowly took my way ğŸŒ«ï¸

I prayed for light, for peace to find âœ¨ğŸ•Šï¸
To leave this sorrow far behind ğŸ˜
Please know my pain was deep and true ğŸ«‚
My battle was more than you knew âš¡

If I leave this world too soon ğŸŒ 
Find me beneath the shining moon ğŸŒŸğŸŒ™
Remember me with love, not grief ğŸ•¯ï¸
Until we meet beyond belief â˜ï¸ğŸ’«`,
        author: "Roshan SHrestha"
      },
      {
        text: `I loved with all my heart and soul â¤ï¸
Though pain inside took its toll ğŸ’”
In darkest hours, I tried to fight ğŸŒ‘
But shadows stole away my light ğŸŒ«ï¸

I wished for peace, for quiet rest âœ¨ğŸ•Šï¸
To ease the ache inside my chest ğŸ˜
To those I loved, please understand ğŸ«‚
My struggle was more than planned âš¡

If my journey ends too soon ğŸŒ 
Look for me in stars and moon ğŸŒŸğŸŒ™
Hold me with love, not despair ğŸ•¯ï¸
Until we meet beyond the air â˜ï¸ğŸ’«`,
        author: "Roshan SHrestha"
      },
      {
        text: `My heart was full of boundless love â¤ï¸
Though pain weighed heavy from above ğŸ’”
In darkest times, I fought to stay ğŸŒ‘
But shadows slowly pulled away ğŸŒ«ï¸

I longed for peace, a gentle light âœ¨ğŸ•Šï¸
To carry me beyond the night ğŸ˜
Please understand my silent pain ğŸ«‚
My battle was more than you'd explain âš¡

If I leave before my time ğŸŒ 
Find me where the stars still shine ğŸŒŸğŸŒ™
Remember me with tender care ğŸ•¯ï¸
Until we meet beyond the air â˜ï¸ğŸ’«`,
        author: "Roshan SHrestha"
      },
      {
        text: `I gave my heart, I gave my all â¤ï¸
Though darkness made me stumble and fall ğŸ’”
In shadows deep, I tried to stay ğŸŒ‘
But night would not let me find my way ğŸŒ«ï¸

I prayed for light, for hope to shine âœ¨ğŸ•Šï¸
To heal the wounds, to make me fine ğŸ˜
Please know my pain was deep and true ğŸ«‚
My fight was more than you ever knew âš¡

If I leave this world too soon ğŸŒ 
Find me under the silver moon ğŸŒŸğŸŒ™
Hold me close with love, not grief ğŸ•¯ï¸
Until we find eternal peace â˜ï¸ğŸ’«`,
        author: "Roshan SHrestha"
      },
      {
        text: `With all my heart, I loved so deep â¤ï¸
Though pain inside would not let me sleep ğŸ’”
In darkest hours, I fought to stay ğŸŒ‘
But shadows slowly took me away ğŸŒ«ï¸

I wished for peace, for gentle rest âœ¨ğŸ•Šï¸
To free my soul and ease my chest ğŸ˜
To those I love, please understand ğŸ«‚
My struggle was more than planned âš¡

If I go before my time ğŸŒ 
Look for me in stars that shine ğŸŒŸğŸŒ™
Remember me with love and light ğŸ•¯ï¸
Until we meet beyond the night â˜ï¸ğŸ’«`,
        author: "Roshan SHrestha"
      },
      {
        text: `I loved you with my whole heart â¤ï¸
Though pain tore my world apart ğŸ’”
In darkness, I tried to hold on tight ğŸŒ‘
But shadows pulled me from the light ğŸŒ«ï¸

I wished for hope, for peace, for calm âœ¨ğŸ•Šï¸
To heal my soul and ease the harm ğŸ˜
Please understand my silent plea ğŸ«‚
My pain was more than you could see âš¡

If I leave this world too soon ğŸŒ 
Find me beneath the glowing moon ğŸŒŸğŸŒ™
Hold me in your heart with care ğŸ•¯ï¸
Until we meet beyond the air â˜ï¸ğŸ’«`,
      
author: "Roshan SHrestha"
     }
     ];

    function updateQuote() {
      const randomQuote = loveQuotes[Math.floor(Math.random() * loveQuotes.length)];
      document.getElementById('quoteText').textContent = randomQuote.text;
      document.getElementById('quoteAuthor').textContent = `- ${randomQuote.author}`;
    }

    // Photo slideshow
    let currentSlideIndex = 0;
    const slides = document.querySelectorAll('.slideshow-slide');
    const dots = document.querySelectorAll('.slideshow-dot');

    function showSlide(n) {
      slides.forEach(slide => slide.classList.remove('active'));
      dots.forEach(dot => dot.classList.remove('active'));
      
      currentSlideIndex = (n - 1 + slides.length) % slides.length;
      slides[currentSlideIndex].classList.add('active');
      dots[currentSlideIndex].classList.add('active');
    }

    function currentSlide(n) {
      showSlide(n);
    }

    function nextSlide() {
      showSlide(currentSlideIndex + 2);
    }

    // Auto-advance slideshow
    setInterval(nextSlide, 5000);

    // Particle system
    function initParticles() {
      if (typeof particlesJS !== 'undefined') {
        particlesJS('particles-js', {
          particles: {
            number: {
              value: 80,
              density: {
                enable: true,
                value_area: 800
              }
            },
            color: {
              value: ['#ff6b9d', '#27ae60', '#e74c3c', '#f39c12']
            },
            shape: {
              type: 'circle'
            },
            opacity: {
              value: 0.5,
              random: false
            },
            size: {
              value: 3,
              random: true
            },
            line_linked: {
              enable: true,
              distance: 150,
              color: '#ff6b9d',
              opacity: 0.4,
              width: 1
            },
            move: {
              enable: true,
              speed: 2,
              direction: 'none',
              random: false,
              straight: false,
              out_mode: 'out',
              bounce: false
            }
          },
          interactivity: {
            detect_on: 'canvas',
            events: {
              onhover: {
                enable: true,
                mode: 'repulse'
              },
              onclick: {
                enable: true,
                mode: 'push'
              },
              resize: true
            }
          },
          retina_detect: true
        });
      }
    }

    // Calendar-accurate difference
    function getCalendarDiff(start, end) {
      let years = end.getFullYear() - start.getFullYear();
      let months = end.getMonth() - start.getMonth();
      let days = end.getDate() - start.getDate();
      let hours = end.getHours() - start.getHours();
      let minutes = end.getMinutes() - start.getMinutes();
      let seconds = end.getSeconds() - start.getSeconds();

      if (seconds < 0) {
        seconds += 60;
        minutes--;
      }
      if (minutes < 0) {
        minutes += 60;
        hours--;
      }
      if (hours < 0) {
        hours += 24;
        days--;
      }
      if (days < 0) {
        // Go to previous month
        let prevMonth = new Date(end.getFullYear(), end.getMonth(), 0);
        days += prevMonth.getDate();
        months--;
      }
      if (months < 0) {
        months += 12;
        years--;
      }
      return { years, months, days, hours, minutes, seconds };
    }

    // Timer functionality with persistent real-time counting
    function startTimer() {
      function getNepalTime() {
        // Use browser's Intl API for real Nepal time
        return new Date(new Date().toLocaleString('en-US', { timeZone: 'Asia/Kathmandu' }));
      }

      // Fetch timer_start.txt and parse start date
      fetch('timer_start.txt?v=' + Date.now())
        .then(res => res.text())
        .then(text => {
          let startDateStr = null;
          text.split('\n').forEach(line => {
            if (line.startsWith('start=')) startDateStr = line.split('=')[1].trim();
          });
          if (!startDateStr) {
            startDateStr = getNepalTime().toISOString().slice(0, 19);
          }
          let [datePart, timePart] = startDateStr.split('T');
          let [year, month, day] = datePart.split('-').map(Number);
          let [hour, minute, second] = (timePart || '00:00:00').split(':').map(Number);

          // Nepal is UTC+5:45, so create the start date in Nepal time
          const NEPAL_OFFSET_MIN = 5 * 60 + 45;
          const utcTimestamp = Date.UTC(year, month - 1, day, hour, minute, second) - (NEPAL_OFFSET_MIN * 60 * 1000);
          const startNepalTime = new Date(utcTimestamp);

          function startAccurateTimer(startNepalTime) {
            function updateTimer() {
              const now = getNepalTime();
              let diff = getCalendarDiff(startNepalTime, now);
              if (
                diff.years < 0 ||
                diff.months < 0 ||
                diff.days < 0 ||
                diff.hours < 0 ||
                diff.minutes < 0 ||
                diff.seconds < 0
              ) {
                diff = { years: 0, months: 0, days: 0, hours: 0, minutes: 0, seconds: 0 };
              } else {
                // Increment seconds by 1 to match the real clock
                diff.seconds += 1;
                if (diff.seconds === 60) {
                  diff.seconds = 0;
                  diff.minutes += 1;
                  if (diff.minutes === 60) {
                    diff.minutes = 0;
                    diff.hours += 1;
                    if (diff.hours === 24) {
                      diff.hours = 0;
                      diff.days += 1;
                      // Optionally, normalize days/months/years further if needed
                    }
                  }
                }
              }
              document.getElementById('timer').innerHTML =
                `â³ ${diff.years} Year ğŸŒŸ ${diff.months} Month ğŸ“… ${diff.days} Day â° ${diff.hours} Hour ğŸ• ${diff.minutes} Minute â± ${diff.seconds} Second and counting...`;

              // Calculate ms until the next full second
              const msToNextSecond = 1000 - now.getMilliseconds();
              setTimeout(updateTimer, msToNextSecond);
            }
            updateTimer();
          }

          startAccurateTimer(startNepalTime);
        });
    }

    // Show nickname question modal before letter
    function showLetter() {
      // Play special sound effect for envelope click
      playEnvelopeSound();
      
      // Add special envelope click effect
      createEnvelopeClickEffect();
      
      document.getElementById('nicknameInput').value = '';
      document.getElementById('nicknameError').textContent = '';
      document.getElementById('nicknameModal').style.display = 'block';
      
      // Add breathing animation to nickname modal
      const nicknameContent = document.querySelector('.nickname-modal-content');
      if (nicknameContent) {
        nicknameContent.style.animation = 'nicknameBreathing 2s ease-in-out infinite';
      }
    }

    // Create envelope click effect
    function createEnvelopeClickEffect() {
      const isMobile = window.innerWidth <= 768;
      
      // Create envelope sparkle effect
      for (let i = 0; i < (isMobile ? 5 : 8); i++) {
        setTimeout(() => {
          const sparkle = document.createElement('div');
          sparkle.innerHTML = 'âœ¨';
          sparkle.style.position = 'fixed';
          sparkle.style.left = '50%';
          sparkle.style.top = '50%';
          sparkle.style.fontSize = isMobile ? '1.5rem' : '2rem';
          sparkle.style.zIndex = '9999';
          sparkle.style.pointerEvents = 'none';
          sparkle.style.animation = 'envelopeSparkle 1.5s ease-out forwards';
          sparkle.style.transform = 'translate(-50%, -50%)';
          document.body.appendChild(sparkle);
          
          setTimeout(() => {
            sparkle.remove();
          }, 1500);
        }, i * 100);
      }
    }

    // Play envelope sound effect
    function playEnvelopeSound() {
      // Create a simple sound effect using Web Audio API
      try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.1);
        
        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
        
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.2);
      } catch (e) {
        // Fallback: just continue without sound
      }
    }

    function closeNicknameModal() {
      const nicknameContent = document.querySelector('.nickname-modal-content');
      if (nicknameContent) {
        nicknameContent.style.animation = '';
      }
      document.getElementById('nicknameModal').style.display = 'none';
    }

    function checkNickname() {
      const input = document.getElementById('nicknameInput').value.trim().toLowerCase();
      if (input === 'koila') {
        // Create celebration effect for correct answer
        createCorrectAnswerEffect();
        
        // Play success sound
        playSuccessSound();
        
        setTimeout(() => {
          closeNicknameModal();
          openLetter();
        }, 1000);
      } else {
        // Create error effect
        createErrorEffect();
        document.getElementById('nicknameError').textContent = 'Remember sweetheart â¤ğŸ’•ğŸŒ¹';
      }
    }

    // Create effect for correct answer
    function createCorrectAnswerEffect() {
      const isMobile = window.innerWidth <= 768;
      
      // Create success sparkles
      for (let i = 0; i < (isMobile ? 8 : 12); i++) {
        setTimeout(() => {
          const sparkle = document.createElement('div');
          sparkle.innerHTML = ['âœ¨', 'ğŸŒŸ', 'ğŸ’–', 'ğŸ‰'][Math.floor(Math.random() * 4)];
          sparkle.style.position = 'fixed';
          sparkle.style.left = Math.random() * window.innerWidth + 'px';
          sparkle.style.top = Math.random() * window.innerHeight + 'px';
          sparkle.style.fontSize = isMobile ? '1.5rem' : '2rem';
          sparkle.style.zIndex = '9999';
          sparkle.style.pointerEvents = 'none';
          sparkle.style.animation = 'sparkleEffect 2s ease-out forwards';
          document.body.appendChild(sparkle);
          
          setTimeout(() => {
            sparkle.remove();
          }, 2000);
        }, i * 100);
      }
    }

    // Create effect for wrong answer
    function createErrorEffect() {
      const errorDiv = document.getElementById('nicknameError');
      errorDiv.style.animation = 'shake 0.5s ease-in-out';
      setTimeout(() => {
        errorDiv.style.animation = '';
      }, 500);
    }

    // Play success sound
    function playSuccessSound() {
      try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.setValueAtTime(523, audioContext.currentTime); // C5
        oscillator.frequency.setValueAtTime(659, audioContext.currentTime + 0.1); // E5
        oscillator.frequency.setValueAtTime(784, audioContext.currentTime + 0.2); // G5
        
        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
        
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.4);
      } catch (e) {
        // Fallback: just continue without sound
      }
    }

    function openLetter() {
      // Create amazing flower and celebration effects
      createLetterOpeningEffects();
      
      const text = translations[currentLanguage].letterText;
      const modal = document.getElementById('letterModal');
      const letterText = document.getElementById('letterText');
      const letterContent = document.querySelector('.letter-content');
      
      // Hide language selector and make music player smaller
      hideControlsForLetter();
      
      // Add special styling to modal for letter opening
      modal.style.display = 'block';
      modal.style.background = 'rgba(0, 0, 0, 0.95)';
      modal.style.backdropFilter = 'blur(20px)';
      
      // Add mobile-specific enhancements
      if (window.innerWidth <= 768) {
        document.body.style.overflow = 'hidden'; // Prevent background scrolling
        letterContent.classList.add('mobile-fullscreen');
      }
      
      // Add breathing animation to letter content
      letterContent.style.animation = 'letterBreathing 3s ease-in-out infinite';
      
      letterText.innerHTML = '';
      let i = 0;
      const typing = setInterval(() => {
        if (i < text.length) {
          letterText.innerHTML += text[i] === '\n' ? '<br>' : text[i];
          i++;
        } else {
          clearInterval(typing);
          // Add final celebration when typing is complete
          setTimeout(() => {
            createLetterCompletionEffects();
          }, 500);
        }
      }, 30); // Slightly faster typing for better experience
    }

    function closeLetter() {
      const modal = document.getElementById('letterModal');
      const letterContent = document.querySelector('.letter-content');
      
      modal.style.display = 'none';
      
      // Restore controls and remove breathing animation
      showControlsAfterLetter();
      letterContent.style.animation = '';
      
      // Restore body overflow for mobile
      if (window.innerWidth <= 768) {
        document.body.style.overflow = '';
        letterContent.classList.remove('mobile-fullscreen');
      }
    }

    // Hide controls when letter is open
    function hideControlsForLetter() {
      // Hide language selector
      const languageSelector = document.getElementById('languageSelector');
      const langToggleBtn = document.querySelector('.lang-toggle-btn');
      if (languageSelector) {
        languageSelector.style.display = 'none';
      }
      if (langToggleBtn) {
        langToggleBtn.style.display = 'none';
      }
      
      // Make music player smaller
      const musicControls = document.querySelector('.music-controls');
      if (musicControls) {
        musicControls.classList.add('letter-mode');
      }
      
      // Hide theme toggle
      const themeToggle = document.querySelector('.theme-toggle');
      if (themeToggle) {
        themeToggle.style.display = 'none';
      }
    }

    // Show controls after letter is closed
    function showControlsAfterLetter() {
      // Show language selector
      const langToggleBtn = document.querySelector('.lang-toggle-btn');
      if (langToggleBtn) {
        langToggleBtn.style.display = 'block';
      }
      
      // Restore music player size
      const musicControls = document.querySelector('.music-controls');
      if (musicControls) {
        musicControls.classList.remove('letter-mode');
      }
      
      // Show theme toggle
      const themeToggle = document.querySelector('.theme-toggle');
      if (themeToggle) {
        themeToggle.style.display = 'block';
      }
    }

    // Create amazing flower effects when letter is opened
    function createLetterOpeningEffects() {
      const isMobile = window.innerWidth <= 768;
      
      // Create flower bloom effect around the screen
      const flowerEmojis = ['ğŸŒ¸', 'ğŸŒº', 'ğŸŒ»', 'ğŸŒ·', 'ğŸŒ¹', 'ğŸŒ¼', 'ğŸŒ¿', 'ğŸ€', 'ğŸŒ±', 'ğŸŒ¾', 'ğŸ’', 'ğŸµï¸'];
      const heartEmojis = ['ğŸ’–', 'ğŸ’•', 'ğŸ’—', 'ğŸ’“', 'ğŸ’', 'ğŸ’˜', 'ğŸ’', 'ğŸ’Ÿ'];
      const sparkleEmojis = ['âœ¨', 'â­', 'ğŸŒŸ', 'ğŸ’«', 'âš¡', 'ğŸ”¥', 'ğŸ’', 'ğŸ†'];
      
      // Create initial flower burst
      for (let i = 0; i < (isMobile ? 15 : 25); i++) {
        setTimeout(() => {
          const flower = document.createElement('div');
          flower.innerHTML = flowerEmojis[Math.floor(Math.random() * flowerEmojis.length)];
          flower.style.position = 'fixed';
          flower.style.left = Math.random() * window.innerWidth + 'px';
          flower.style.top = Math.random() * window.innerHeight + 'px';
          flower.style.fontSize = isMobile ? '2rem' : '3rem';
          flower.style.zIndex = '9999';
          flower.style.pointerEvents = 'none';
          flower.style.animation = 'flowerBloom 3s ease-out forwards';
          flower.style.transform = 'scale(0)';
          document.body.appendChild(flower);
          
          setTimeout(() => {
            flower.remove();
          }, 3000);
        }, i * 50);
      }
      
      // Create heart rain effect
      for (let i = 0; i < (isMobile ? 20 : 35); i++) {
        setTimeout(() => {
          const heart = document.createElement('div');
          heart.innerHTML = heartEmojis[Math.floor(Math.random() * heartEmojis.length)];
          heart.style.position = 'fixed';
          heart.style.left = Math.random() * window.innerWidth + 'px';
          heart.style.top = '-50px';
          heart.style.fontSize = isMobile ? '1.5rem' : '2rem';
          heart.style.zIndex = '9998';
          heart.style.pointerEvents = 'none';
          heart.style.animation = 'floatUp 4s ease-out forwards';
          document.body.appendChild(heart);
          
          setTimeout(() => {
            heart.remove();
          }, 4000);
        }, i * 80);
      }
      
      // Create sparkle effects
      for (let i = 0; i < (isMobile ? 12 : 20); i++) {
        setTimeout(() => {
          const sparkle = document.createElement('div');
          sparkle.innerHTML = sparkleEmojis[Math.floor(Math.random() * sparkleEmojis.length)];
          sparkle.style.position = 'fixed';
          sparkle.style.left = Math.random() * window.innerWidth + 'px';
          sparkle.style.top = Math.random() * window.innerHeight + 'px';
          sparkle.style.fontSize = isMobile ? '1.8rem' : '2.5rem';
          sparkle.style.zIndex = '9997';
          sparkle.style.pointerEvents = 'none';
          sparkle.style.animation = 'sparkleEffect 2s ease-in-out infinite';
          document.body.appendChild(sparkle);
          
          setTimeout(() => {
            sparkle.remove();
          }, 4000);
        }, i * 100);
      }
      
      // Create floating petals effect
      for (let i = 0; i < (isMobile ? 8 : 15); i++) {
        setTimeout(() => {
          const petal = document.createElement('div');
          petal.innerHTML = 'ğŸŒ¸';
          petal.style.position = 'fixed';
          petal.style.left = Math.random() * window.innerWidth + 'px';
          petal.style.top = Math.random() * window.innerHeight + 'px';
          petal.style.fontSize = isMobile ? '1.2rem' : '1.8rem';
          petal.style.zIndex = '9996';
          petal.style.pointerEvents = 'none';
          petal.style.animation = 'floatingPetal 6s ease-in-out infinite';
          document.body.appendChild(petal);
          
          setTimeout(() => {
            petal.remove();
          }, 6000);
        }, i * 200);
      }
    }

    // Create completion effects when letter typing is finished
    function createLetterCompletionEffects() {
      const isMobile = window.innerWidth <= 768;
      
      // Create final celebration burst
      for (let i = 0; i < (isMobile ? 10 : 20); i++) {
        setTimeout(() => {
          const celebration = document.createElement('div');
          celebration.innerHTML = ['ğŸ‰', 'ğŸŠ', 'ğŸ’–', 'âœ¨', 'ğŸŒŸ', 'ğŸ’«'][Math.floor(Math.random() * 6)];
          celebration.style.position = 'fixed';
          celebration.style.left = Math.random() * window.innerWidth + 'px';
          celebration.style.top = Math.random() * window.innerHeight + 'px';
          celebration.style.fontSize = isMobile ? '2rem' : '3rem';
          celebration.style.zIndex = '9999';
          celebration.style.pointerEvents = 'none';
          celebration.style.animation = 'celebrationBurst 2s ease-out forwards';
          document.body.appendChild(celebration);
          
          setTimeout(() => {
            celebration.remove();
          }, 2000);
        }, i * 100);
      }
      
      // Create love message floating up
      setTimeout(() => {
        const loveMessage = document.createElement('div');
        loveMessage.innerHTML = 'ğŸ’– Love Letter Opened! ğŸ’–';
        loveMessage.style.position = 'fixed';
        loveMessage.style.left = '50%';
        loveMessage.style.top = '50%';
        loveMessage.style.transform = 'translate(-50%, -50%)';
        loveMessage.style.fontSize = isMobile ? '1.5rem' : '2rem';
        loveMessage.style.color = '#ff6b9d';
        loveMessage.style.fontWeight = 'bold';
        loveMessage.style.zIndex = '10000';
        loveMessage.style.pointerEvents = 'none';
        loveMessage.style.animation = 'loveMessageFloat 3s ease-out forwards';
        loveMessage.style.textShadow = '2px 2px 4px rgba(0,0,0,0.5)';
        document.body.appendChild(loveMessage);
        
        setTimeout(() => {
          loveMessage.remove();
        }, 3000);
      }, 500);
    }

    // Enhanced Photo modal functionality with zoom and navigation
    let currentImageIndex = 0;
    let currentZoom = 1;
    let isDragging = false;
    let dragStart = { x: 0, y: 0 };
    let imageOffset = { x: 0, y: 0 };

    // Image data for navigation
    const imageData = [
      { src: 'images/000.jpg', title: 'Beautiful Memory' },
      { src: 'images/00001.jpg', title: 'Precious Moment' },
      { src: 'images/00002.jpg', title: 'Love Story' },
      { src: 'images/00098.jpg', title: 'Endless Love' },
      { src: 'images/001.jpg', title: 'Perfect Together' },
      { src: 'images/002.jpg', title: 'Sweet Moments' },
      { src: 'images/003.jpg', title: 'My Everything' },
      { src: 'images/0089.jpg', title: 'Special Memory' }
    ];

    function openPhotoModal(src) {
      // Find the index of the clicked image
      currentImageIndex = imageData.findIndex(img => img.src === src);
      if (currentImageIndex === -1) currentImageIndex = 0;
      
      // Reset zoom and position
      currentZoom = 1;
      imageOffset = { x: 0, y: 0 };
      
      // Update modal content
      updateModalContent();
      
      // Show modal
      document.getElementById('photoModal').style.display = 'block';
      
      // Add event listeners for zoom and drag
      addImageEventListeners();
    }

    function closePhotoModal() {
      document.getElementById('photoModal').style.display = 'none';
      removeImageEventListeners();
    }

    function updateModalContent() {
      const currentImage = imageData[currentImageIndex];
      const modalImage = document.getElementById('modalImage');
      const imageCounter = document.getElementById('imageCounter');
      const imageTitle = document.getElementById('imageTitle');
      
      modalImage.src = currentImage.src;
      imageCounter.textContent = `${currentImageIndex + 1} / ${imageData.length}`;
      imageTitle.textContent = currentImage.title;
      
      // Reset image transform
      modalImage.style.transform = 'translate(0px, 0px) scale(1)';
    }

    // Zoom functions
    function zoomIn() {
      currentZoom = Math.min(currentZoom * 1.2, 5);
      applyTransform();
    }

    function zoomOut() {
      currentZoom = Math.max(currentZoom / 1.2, 0.5);
      applyTransform();
    }

    function resetZoom() {
      currentZoom = 1;
      imageOffset = { x: 0, y: 0 };
      applyTransform();
    }

    function fitToScreen() {
      currentZoom = 1;
      imageOffset = { x: 0, y: 0 };
      applyTransform();
    }

    function applyTransform() {
      const modalImage = document.getElementById('modalImage');
      const imageContainer = document.getElementById('imageContainer');
      
      modalImage.style.transform = `translate(${imageOffset.x}px, ${imageOffset.y}px) scale(${currentZoom})`;
      
      // Add/remove draggable class based on zoom level
      if (currentZoom > 1) {
        imageContainer.classList.add('draggable');
      } else {
        imageContainer.classList.remove('draggable');
        imageContainer.style.cursor = 'default';
      }
    }

    // Navigation functions
    function previousImage() {
      currentImageIndex = (currentImageIndex - 1 + imageData.length) % imageData.length;
      resetZoom();
      updateModalContent();
    }

    function nextImage() {
      currentImageIndex = (currentImageIndex + 1) % imageData.length;
      resetZoom();
      updateModalContent();
    }

    // Mouse wheel zoom
    function handleWheel(e) {
      e.preventDefault();
      const delta = e.deltaY > 0 ? 0.9 : 1.1;
      currentZoom = Math.max(0.5, Math.min(5, currentZoom * delta));
      applyTransform();
    }

    // Enhanced drag functionality for panning zoomed images
    function handleMouseDown(e) {
      if (currentZoom > 1) {
        isDragging = true;
        dragStart.x = e.clientX - imageOffset.x;
        dragStart.y = e.clientY - imageOffset.y;
        document.getElementById('imageContainer').style.cursor = 'grabbing';
        e.preventDefault();
      }
    }

    function handleMouseMove(e) {
      if (isDragging && currentZoom > 1) {
        const newX = e.clientX - dragStart.x;
        const newY = e.clientY - dragStart.y;
        
        // Get image and container dimensions for boundary checking
        const imageContainer = document.getElementById('imageContainer');
        const modalImage = document.getElementById('modalImage');
        const containerRect = imageContainer.getBoundingClientRect();
        const imageRect = modalImage.getBoundingClientRect();
        
        // Calculate boundaries to prevent dragging too far
        const maxOffsetX = Math.max(0, (imageRect.width * currentZoom - containerRect.width) / 2);
        const maxOffsetY = Math.max(0, (imageRect.height * currentZoom - containerRect.height) / 2);
        
        // Constrain movement within boundaries
        imageOffset.x = Math.max(-maxOffsetX, Math.min(maxOffsetX, newX));
        imageOffset.y = Math.max(-maxOffsetY, Math.min(maxOffsetY, newY));
        
        applyTransform();
        e.preventDefault();
      }
    }

    function handleMouseUp(e) {
      if (isDragging) {
        isDragging = false;
        document.getElementById('imageContainer').style.cursor = currentZoom > 1 ? 'grab' : 'default';
        e.preventDefault();
      }
    }

    // Enhanced touch gestures for mobile (zoom and pan)
    let lastTouchDistance = 0;
    let lastTouchCenter = { x: 0, y: 0 };
    let isTouchDragging = false;
    let touchStart = { x: 0, y: 0 };

    function handleTouchStart(e) {
      if (e.touches.length === 1) {
        // Single touch - start panning if zoomed
        if (currentZoom > 1) {
          isTouchDragging = true;
          touchStart.x = e.touches[0].clientX - imageOffset.x;
          touchStart.y = e.touches[0].clientY - imageOffset.y;
        }
      } else if (e.touches.length === 2) {
        // Two touches - start zooming
        isTouchDragging = false;
        const touch1 = e.touches[0];
        const touch2 = e.touches[1];
        lastTouchDistance = Math.sqrt(
          Math.pow(touch2.clientX - touch1.clientX, 2) +
          Math.pow(touch2.clientY - touch1.clientY, 2)
        );
        lastTouchCenter = {
          x: (touch1.clientX + touch2.clientX) / 2,
          y: (touch1.clientY + touch2.clientY) / 2
        };
      }
    }

    function handleTouchMove(e) {
      e.preventDefault();
      
      if (e.touches.length === 1 && isTouchDragging && currentZoom > 1) {
        // Single touch panning
        const touch = e.touches[0];
        const newX = touch.clientX - touchStart.x;
        const newY = touch.clientY - touchStart.y;
        
        // Get boundaries for touch panning
        const imageContainer = document.getElementById('imageContainer');
        const modalImage = document.getElementById('modalImage');
        const containerRect = imageContainer.getBoundingClientRect();
        const imageRect = modalImage.getBoundingClientRect();
        
        const maxOffsetX = Math.max(0, (imageRect.width * currentZoom - containerRect.width) / 2);
        const maxOffsetY = Math.max(0, (imageRect.height * currentZoom - containerRect.height) / 2);
        
        imageOffset.x = Math.max(-maxOffsetX, Math.min(maxOffsetX, newX));
        imageOffset.y = Math.max(-maxOffsetY, Math.min(maxOffsetY, newY));
        
        applyTransform();
        
      } else if (e.touches.length === 2) {
        // Two touches - zooming
        const touch1 = e.touches[0];
        const touch2 = e.touches[1];
        const currentDistance = Math.sqrt(
          Math.pow(touch2.clientX - touch1.clientX, 2) +
          Math.pow(touch2.clientY - touch1.clientY, 2)
        );
        
        if (lastTouchDistance > 0) {
          const scale = currentDistance / lastTouchDistance;
          currentZoom = Math.max(0.5, Math.min(5, currentZoom * scale));
          applyTransform();
        }
        
        lastTouchDistance = currentDistance;
      }
    }

    function handleTouchEnd(e) {
      if (e.touches.length === 0) {
        // All touches ended
        isTouchDragging = false;
        lastTouchDistance = 0;
      } else if (e.touches.length === 1) {
        // One touch ended, but another might still be active
        lastTouchDistance = 0;
      }
    }

    // Add event listeners
    function addImageEventListeners() {
      const imageContainer = document.getElementById('imageContainer');
      const modalImage = document.getElementById('modalImage');
      
      imageContainer.addEventListener('wheel', handleWheel, { passive: false });
      imageContainer.addEventListener('mousedown', handleMouseDown);
      document.addEventListener('mousemove', handleMouseMove);
      document.addEventListener('mouseup', handleMouseUp);
      
      // Touch events
      imageContainer.addEventListener('touchstart', handleTouchStart, { passive: false });
      imageContainer.addEventListener('touchmove', handleTouchMove, { passive: false });
      imageContainer.addEventListener('touchend', handleTouchEnd);
      
      // Keyboard navigation
      document.addEventListener('keydown', handleKeyDown);
    }

    function removeImageEventListeners() {
      const imageContainer = document.getElementById('imageContainer');
      
      imageContainer.removeEventListener('wheel', handleWheel);
      imageContainer.removeEventListener('mousedown', handleMouseDown);
      document.removeEventListener('mousemove', handleMouseMove);
      document.removeEventListener('mouseup', handleMouseUp);
      
      imageContainer.removeEventListener('touchstart', handleTouchStart);
      imageContainer.removeEventListener('touchmove', handleTouchMove);
      imageContainer.removeEventListener('touchend', handleTouchEnd);
      
      document.removeEventListener('keydown', handleKeyDown);
    }

    // Keyboard navigation
    function handleKeyDown(e) {
      switch(e.key) {
        case 'ArrowLeft':
          previousImage();
          break;
        case 'ArrowRight':
          nextImage();
          break;
        case 'Escape':
          closePhotoModal();
          break;
        case '+':
        case '=':
          zoomIn();
          break;
        case '-':
          zoomOut();
          break;
        case '0':
          resetZoom();
          break;
      }
    }

    // Music functionality
    function initializeMusic(shouldPlay = false) {
      const music = document.getElementById('bgMusic');
      const toggleBtn = document.getElementById('musicToggle');
      const volumeSlider = document.getElementById('volumeControl');
      const prevBtn = document.getElementById('prevTrackBtn');
      const nextBtn = document.getElementById('nextTrackBtn');
      const trackTitle = document.getElementById('currentTrackTitle');
      
      // Hardcoded music tracks for static hosting (GitHub Pages compatible)
      let musicTracks = [
        { src: 'music/7_years.mp3', title: '7 Years' },
        { src: 'music/Par khe ra .mp3', title: 'Par khe ra' },
        { src: 'music/Thu Hea Kha.mp3', title: 'Thu Hea Kha' }
      ];
      window.musicTracks = musicTracks;
      
      // Only initialize currentTrackIndex if not already set, or pick random if shouldPlay is true
      if (window.currentTrackIndex === undefined || shouldPlay) {
        window.currentTrackIndex = Math.floor(Math.random() * musicTracks.length);
      }
      
      function loadTrack(index, autoPlay = true) {
        if (!musicTracks[index]) {
          trackTitle.textContent = 'No songs found';
          music.src = '';
          return;
        }
        music.src = musicTracks[index].src;
        trackTitle.textContent = musicTracks[index].title;
        music.load();
        localStorage.setItem('lastMusicIndex', index);
        
        if (autoPlay) {
          // Wait for metadata to load before playing
          music.addEventListener('loadedmetadata', function() {
            // Set start time to 10 seconds for 7 Years song
            if (musicTracks[index].title === '7 Years') {
              music.currentTime = 10; // Start from 10 seconds
            }
            
            const playPromise = music.play();
            if (playPromise !== undefined) {
              playPromise.then(() => {
                console.log('Music started successfully');
                updateMusicIcon();
              }).catch(error => {
                console.log('Autoplay prevented, waiting for user interaction');
                // Music will start when user clicks play button
              });
            }
          }, { once: true });
        } else {
          // Set start time to 10 seconds for 7 Years song even if not autoplaying
          if (musicTracks[index].title === '7 Years') {
            music.addEventListener('loadedmetadata', function() {
              music.currentTime = 10; // Start from 10 seconds
            }, { once: true });
          }
        }
      }
      
      // Set initial volume
      music.volume = 0.5;
      
      // Volume control
      volumeSlider.addEventListener('input', function() {
        music.volume = this.value;
      });
      
      // Update icon based on music state
      function updateMusicIcon() {
        if (music.paused) {
          toggleBtn.innerHTML = '<i class="fas fa-play"></i>';
        } else {
          toggleBtn.innerHTML = '<i class="fas fa-pause"></i>';
        }
        if (window.musicTracks && window.currentTrackIndex !== undefined && window.musicTracks[window.currentTrackIndex]) {
          trackTitle.textContent = window.musicTracks[window.currentTrackIndex].title;
        } else {
          trackTitle.textContent = 'No songs found';
        }
      }
      
      // Listen for play/pause events to update icon
      music.addEventListener('play', updateMusicIcon);
      music.addEventListener('pause', updateMusicIcon);
      
      // Next/Prev track
      window.playNextTrack = function() {
        if (!musicTracks.length) return;
        window.currentTrackIndex = (window.currentTrackIndex + 1) % musicTracks.length;
        loadTrack(window.currentTrackIndex, true);
        updateMusicIcon();
      };
      
      window.playPrevTrack = function() {
        if (!musicTracks.length) return;
        window.currentTrackIndex = (window.currentTrackIndex - 1 + musicTracks.length) % musicTracks.length;
        loadTrack(window.currentTrackIndex, true);
        updateMusicIcon();
      };
      
      // Initial icon and track (pick random on each load)
      if (musicTracks.length > 0) {
        loadTrack(window.currentTrackIndex, shouldPlay);
        updateMusicIcon();
      } else {
        trackTitle.textContent = 'No songs found';
      }
    }

    // Function to start music when user interacts (after autoplay is blocked)
    window.startMusicOnUserInteraction = function() {
      const music = document.getElementById('bgMusic');
      const toggleBtn = document.getElementById('musicToggle');
      
      // Ensure music is initialized with a random track
      if (window.musicTracks && window.currentTrackIndex === undefined) {
        window.currentTrackIndex = Math.floor(Math.random() * window.musicTracks.length);
      }
      
      // If music source is not set, load the track first
      if (!music.src || music.src === '' || music.src === window.location.href) {
        if (window.musicTracks && window.currentTrackIndex !== undefined) {
          const track = window.musicTracks[window.currentTrackIndex];
          music.src = track.src;
          music.load();
          
          // Set start time to 10 seconds for 7 Years song
          if (track.title === '7 Years') {
            music.addEventListener('loadedmetadata', function() {
              music.currentTime = 10;
              music.play().then(() => {
                toggleBtn.innerHTML = '<i class=\'fas fa-pause\'></i>';
                console.log('Music started after user interaction');
              }).catch(error => {
                console.log('Failed to start music:', error);
              });
            }, { once: true });
          } else {
            music.addEventListener('loadeddata', function() {
              music.play().then(() => {
                toggleBtn.innerHTML = '<i class=\'fas fa-pause\'></i>';
                console.log('Music started after user interaction');
              }).catch(error => {
                console.log('Failed to start music:', error);
              });
            }, { once: true });
          }
        }
      } else {
        // Music is already loaded, just play it
        if (music.paused) {
          // Set start time to 10 seconds for 7 Years song
          if (window.musicTracks && window.currentTrackIndex !== undefined && 
              window.musicTracks[window.currentTrackIndex].title === '7 Years') {
            if (music.currentTime < 10) {
              music.currentTime = 10; // Start from 10 seconds
            }
          }
          
          music.play().then(() => {
            toggleBtn.innerHTML = '<i class=\'fas fa-pause\'></i>';
            console.log('Music started after user interaction');
          }).catch(error => {
            console.log('Failed to start music:', error);
          });
        }
      }
    }

    // Single button to play/pause music
    function toggleMusicPlayPause() {
      const music = document.getElementById('bgMusic');
      const toggleBtn = document.getElementById('musicToggle');
      if (music.paused) {
        // Set start time to 10 seconds for 7 Years song
        if (window.musicTracks && window.currentTrackIndex !== undefined && 
            window.musicTracks[window.currentTrackIndex].title === '7 Years') {
          music.currentTime = 10; // Start from 10 seconds
        }
        
        music.play().then(() => {
          toggleBtn.innerHTML = '<i class=\'fas fa-pause\'></i>';
        });
      } else {
        music.pause();
        toggleBtn.innerHTML = '<i class=\'fas fa-play\'></i>';
      }
      // Always update the song title
      const trackTitle = document.getElementById('currentTrackTitle');
      if (window.currentTrackIndex !== undefined && window.musicTracks) {
        trackTitle.textContent = window.musicTracks[window.currentTrackIndex].title;
      }
    }

    // Called by overlay button
    function playMusicFromOverlay() {
      const music = document.getElementById('bgMusic');
      const musicOverlay = document.getElementById('musicOverlay');
      music.play().then(() => {
        musicOverlay.style.display = 'none';
      });
    }

    // Photo upload functionality
    function initializePhotoUpload() {
      document.getElementById('photoInput').addEventListener('change', function(e) {
        const grid = document.getElementById('photoGrid');
        const files = Array.from(e.target.files);
        
        files.forEach(file => {
          if (file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = function(event) {
              const photoItem = document.createElement('div');
              photoItem.className = 'photo-item';
              photoItem.innerHTML = `
                <img src="${event.target.result}" alt="Uploaded Memory" onclick="openPhotoModal('${event.target.result}')">
                <div class="photo-overlay">
                  <h3>New Memory</h3>
                  <p>Added with love</p>
                </div>
              `;
              grid.appendChild(photoItem);
              
              // Add animation
              photoItem.style.opacity = '0';
              photoItem.style.transform = 'scale(0.8)';
              setTimeout(() => {
                photoItem.style.transition = 'all 0.5s ease';
                photoItem.style.opacity = '1';
                photoItem.style.transform = 'scale(1)';
              }, 100);
            };
            reader.readAsDataURL(file);
          }
        });
      });
    }

    // Close modals when clicking outside
    window.addEventListener('click', function(e) {
      const letterModal = document.getElementById('letterModal');
      const photoModal = document.getElementById('photoModal');
      
      if (e.target === letterModal) {
        closeLetter();
      }
      if (e.target === photoModal) {
        closePhotoModal();
      }
    });

    // Add interactive effects
    document.addEventListener('mousemove', function(e) {
      const elements = document.querySelectorAll('.floating-item');
      elements.forEach(element => {
        const rect = element.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        
        if (Math.abs(x) < 60 && Math.abs(y) < 60) {
          element.style.transform = 'scale(1.8) rotate(10deg)';
        }
      });
    });

    // Sound effects
    function playClickSound() {
      const clickSound = document.getElementById('clickSound');
      clickSound.currentTime = 0;
      clickSound.play().catch(() => {});
    }

    function playHoverSound() {
      const hoverSound = document.getElementById('hoverSound');
      hoverSound.currentTime = 0;
      hoverSound.play().catch(() => {});
    }

    // Add sound effects to interactive elements
    document.addEventListener('DOMContentLoaded', function() {
      const interactiveElements = document.querySelectorAll('button, .envelope, .photo-item, .lang-btn, .theme-toggle');
      interactiveElements.forEach(el => {
        el.addEventListener('click', playClickSound);
        el.addEventListener('mouseenter', playHoverSound);
      });
    });

    // Function to reset timer (for testing purposes)
    function resetTimer() {
      localStorage.removeItem('loveStartTime');
      location.reload();
    }

    // Function to show current Nepal time
    function showNepalTime() {
      function getNepalTime() {
        // Use browser's Intl API for real Nepal time
        return new Date(new Date().toLocaleString('en-US', { timeZone: 'Asia/Kathmandu' }));
      }
      
      const nepalTime = getNepalTime();
      alert(`Current Nepal Time: ${nepalTime.toLocaleString('en-US', { timeZone: 'Asia/Kathmandu' })}`);
    }

    // Add these functions to window for debugging (optional)
    window.resetTimer = resetTimer;
    window.showNepalTime = showNepalTime;

    // Ensure all translation keys exist for all languages
    const allKeys = [
      'headerSubtitle', 'timerSubtitle', 'calculatorTitle', 'quotesTitle', 'letterTitle', 'letterHeader',
      'memoriesTitle', 'uploadTitle', 'uploadSubtitle', 'uploadBtnText', 'footerText', 'letterText'
    ];
    Object.keys(translations).forEach(lang => {
      allKeys.forEach(key => {
        if (!translations[lang][key]) {
          translations[lang][key] = translations['en'][key] || '';
        }
      });
    });

    // Toggle language selector
    function toggleLanguageSelector() {
      const selector = document.getElementById('languageSelector');
      const themeToggle = document.querySelector('.theme-toggle');
      
      if (selector.style.display === 'none' || selector.style.display === '') {
        // Opening language selector
        selector.style.display = 'flex';
        themeToggle.classList.remove('language-closed');
        themeToggle.classList.add('language-open');
      } else {
        // Closing language selector
        selector.style.display = 'none';
        themeToggle.classList.remove('language-open');
        themeToggle.classList.add('language-closed');
      }
    }

    // Improved language change function
    function changeLanguage(event, lang) {
      currentLanguage = lang;
      const langBtns = document.querySelectorAll('.lang-btn');
      const themeToggle = document.querySelector('.theme-toggle');
      
      langBtns.forEach(btn => btn.classList.remove('active'));
      if (event && event.currentTarget) event.currentTarget.classList.add('active');
      
      // Update all text elements
      allKeys.forEach(key => {
        const el = document.getElementById(key);
        if (el) el.textContent = translations[lang][key];
      });
      
      // Hide selector after choosing and hide theme button
      document.getElementById('languageSelector').style.display = 'none';
      themeToggle.classList.remove('language-open');
      themeToggle.classList.add('language-closed');
      
      // Persist language and reflect in URL
      try {
        localStorage.setItem('lang', lang);
        const url = new URL(window.location);
        url.searchParams.set('lang', lang);
        history.replaceState({}, '', url);
      } catch (e) {}
    }

    // Play music directly from button
    function playMusicDirect() {
      const music = document.getElementById('bgMusic');
      const toggleBtn = document.getElementById('musicToggle');
      music.play().then(() => {
        toggleBtn.innerHTML = '<i class="fas fa-music"></i>';
      });
    }

    // Initialize draggable music player
    function initializeDraggableMusic() {
      const musicControls = document.getElementById('musicControls');
      const dragHandle = document.querySelector('.drag-handle');
      
      // Load saved position
      loadMusicPosition();
      
      // Add event listeners for dragging
      dragHandle.addEventListener('mousedown', handleMusicMouseDown);
      document.addEventListener('mousemove', handleMusicMouseMove);
      document.addEventListener('mouseup', handleMusicMouseUp);
      
      // Touch events for mobile
      dragHandle.addEventListener('touchstart', handleMusicTouchStart, { passive: false });
      document.addEventListener('touchmove', handleMusicTouchMove, { passive: false });
      document.addEventListener('touchend', handleMusicTouchEnd);
    }

    // Mouse events for dragging music player
    function handleMusicMouseDown(e) {
      isMusicDragging = true;
      musicDragStart.x = e.clientX - musicOffset.x;
      musicDragStart.y = e.clientY - musicOffset.y;
      
      const musicControls = document.getElementById('musicControls');
      musicControls.classList.add('dragging');
      e.preventDefault();
    }

    function handleMusicMouseMove(e) {
      if (isMusicDragging) {
        const newX = e.clientX - musicDragStart.x;
        const newY = e.clientY - musicDragStart.y;
        
        // Constrain to viewport
        const musicControls = document.getElementById('musicControls');
        const rect = musicControls.getBoundingClientRect();
        const maxX = window.innerWidth - rect.width;
        const maxY = window.innerHeight - rect.height;
        
        musicOffset.x = Math.max(0, Math.min(maxX, newX));
        musicOffset.y = Math.max(0, Math.min(maxY, newY));
        
        applyMusicPosition();
        e.preventDefault();
      }
    }

    function handleMusicMouseUp(e) {
      if (isMusicDragging) {
        isMusicDragging = false;
        const musicControls = document.getElementById('musicControls');
        musicControls.classList.remove('dragging');
        saveMusicPosition();
        e.preventDefault();
      }
    }

    // Touch events for mobile dragging
    function handleMusicTouchStart(e) {
      if (e.touches.length === 1) {
        isMusicDragging = true;
        musicDragStart.x = e.touches[0].clientX - musicOffset.x;
        musicDragStart.y = e.touches[0].clientY - musicOffset.y;
        
        const musicControls = document.getElementById('musicControls');
        musicControls.classList.add('dragging');
        e.preventDefault();
      }
    }

    function handleMusicTouchMove(e) {
      if (isMusicDragging && e.touches.length === 1) {
        const newX = e.touches[0].clientX - musicDragStart.x;
        const newY = e.touches[0].clientY - musicDragStart.y;
        
        // Constrain to viewport
        const musicControls = document.getElementById('musicControls');
        const rect = musicControls.getBoundingClientRect();
        const maxX = window.innerWidth - rect.width;
        const maxY = window.innerHeight - rect.height;
        
        musicOffset.x = Math.max(0, Math.min(maxX, newX));
        musicOffset.y = Math.max(0, Math.min(maxY, newY));
        
        applyMusicPosition();
        e.preventDefault();
      }
    }

    function handleMusicTouchEnd(e) {
      if (isMusicDragging) {
        isMusicDragging = false;
        const musicControls = document.getElementById('musicControls');
        musicControls.classList.remove('dragging');
        saveMusicPosition();
        e.preventDefault();
      }
    }

    // Apply music player position
    function applyMusicPosition() {
      const musicControls = document.getElementById('musicControls');
      musicControls.style.left = musicOffset.x + 'px';
      musicControls.style.top = musicOffset.y + 'px';
    }

    // Save music player position
    function saveMusicPosition() {
      localStorage.setItem('musicPosition', JSON.stringify(musicOffset));
    }

    // Load music player position
    function loadMusicPosition() {
      const saved = localStorage.getItem('musicPosition');
      if (saved) {
        try {
          musicOffset = JSON.parse(saved);
          applyMusicPosition();
        } catch (e) {
          // Use default position if saved data is invalid
          musicOffset = { x: 20, y: 20 };
        }
      }
    }

    // Initialize scroll behavior for language button
    function initializeScrollBehavior() {
      const langToggleBtn = document.querySelector('.lang-toggle-btn');
      const themeToggleBtn = document.querySelector('.theme-toggle');
      
      window.addEventListener('scroll', function() {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        
        // Hide both buttons when scrolling down (instant)
        if (scrollTop > lastScrollTop && scrollTop > 50) {
          langToggleBtn.classList.add('hidden');
          // Force hide theme button by adding hidden class and removing conflicting classes
          themeToggleBtn.classList.add('hidden');
          themeToggleBtn.classList.remove('language-open', 'language-closed');
        }
        // Show both buttons when scrolling up (instant)
        else if (scrollTop < lastScrollTop) {
          langToggleBtn.classList.remove('hidden');
          // Show theme button and restore proper state
          themeToggleBtn.classList.remove('hidden');
          // Check if language selector is open to determine proper state
          const languageSelector = document.getElementById('languageSelector');
          if (languageSelector && languageSelector.style.display === 'flex') {
            themeToggleBtn.classList.add('language-open');
          } else {
            themeToggleBtn.classList.add('language-closed');
          }
        }
        
        // Update last scroll position
        lastScrollTop = scrollTop;
      }, { passive: true });
    }

    // Love Panda Game Functions
    function initializeLovePandaGame() {
      const startBtn = document.getElementById('startGame');
      const resetBtn = document.getElementById('resetGame');
      
      startBtn.addEventListener('click', startGame);
      resetBtn.addEventListener('click', resetGame);
      
      // Keyboard controls
      document.addEventListener('keydown', handleGameKeyPress);
      
      // Mobile touch controls
      const gameBoard = document.getElementById('gameBoard');
      let touchStartX = 0;
      let touchStartY = 0;
      
      gameBoard.addEventListener('touchstart', function(e) {
        e.preventDefault();
        touchStartX = e.touches[0].clientX;
        touchStartY = e.touches[0].clientY;
      }, { passive: false });
      
      gameBoard.addEventListener('touchend', function(e) {
        e.preventDefault();
        if (!gameState.isPlaying) return;
        
        const touchEndX = e.changedTouches[0].clientX;
        const touchEndY = e.changedTouches[0].clientY;
        
        const deltaX = touchEndX - touchStartX;
        const deltaY = touchEndY - touchStartY;
        
        const minSwipeDistance = 30;
        
        if (Math.abs(deltaX) > Math.abs(deltaY)) {
          // Horizontal swipe
          if (Math.abs(deltaX) > minSwipeDistance) {
            if (deltaX > 0) {
              movePanda('right');
            } else {
              movePanda('left');
            }
          }
        } else {
          // Vertical swipe
          if (Math.abs(deltaY) > minSwipeDistance) {
            if (deltaY > 0) {
              movePanda('down');
            } else {
              movePanda('up');
            }
          }
        }
      }, { passive: false });
      
      // Update displays
      document.getElementById('highScore').textContent = gameState.highScore;
      document.getElementById('gamesPlayed').textContent = gameState.gamesPlayed;
      document.getElementById('totalHearts').textContent = gameState.totalItems;
      
      // Setup difficulty selector
      const difficultySelect = document.getElementById('difficultySelect');
      difficultySelect.value = gameState.difficulty;
      difficultySelect.addEventListener('change', function() {
        gameState.difficulty = this.value;
        localStorage.setItem('pandaDifficulty', this.value);
      });
      
      // Place panda at start position
      placePanda();
      placeItem();
    }

    function startGame() {
      gameState.isPlaying = true;
      gameState.score = 0;
      gameState.itemsCollected = 0;
      gameState.level = parseInt(gameState.currentLevel);
      gameState.boomCount = 0;
      
      // Load level configuration
      const config = levelConfigs[gameState.level] || levelConfigs[1];
      const difficulty = difficultyLevels[gameState.difficulty] || difficultyLevels.medium;
      
      // Apply difficulty multipliers
      gameState.itemsNeeded = Math.ceil(config.itemsNeeded * difficulty.itemsNeededMultiplier);
      gameState.gameSpeed = config.speed * difficulty.speedMultiplier;
      gameState.itemSpawnRate = config.spawnRate * difficulty.spawnRateMultiplier;
      gameState.availableItems = config.items;
      
      // Hide instructions
      document.getElementById('gameInstructions').style.display = 'none';
      
      // Update UI
      updateGameUI();
      
      // Place item at random position
      placeItem();
    }

    function resetGame() {
      gameState.isPlaying = false;
      gameState.score = 0;
      gameState.pandaX = 50;
      gameState.pandaY = 50;
      
      // Show instructions
      document.getElementById('gameInstructions').style.display = 'block';
      
      // Reset positions
      placePanda();
      placeHeart();
      
      // Update UI
      updateGameUI();
    }

    function placePanda() {
      const panda = document.getElementById('panda');
      panda.style.left = gameState.pandaX + 'px';
      panda.style.top = gameState.pandaY + 'px';
    }

    function placeItem() {
      const itemElement = document.getElementById('heart'); // Reusing the heart element
      const gameBoard = document.getElementById('gameBoard');
      const boardRect = gameBoard.getBoundingClientRect();
      
      // Select random item from available items
      const randomItemType = gameState.availableItems[Math.floor(Math.random() * gameState.availableItems.length)];
      const itemData = collectibleItems[randomItemType];
      
      // Update the item element
      itemElement.textContent = itemData.emoji;
      itemElement.style.color = itemData.color;
      itemElement.style.fontSize = '2.5rem';
      itemElement.style.filter = 'drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.3))';
      
      // Store current item data
      gameState.currentItem = {
        type: randomItemType,
        data: itemData
      };
      
      // Random position within game board (accounting for element size)
      const maxX = boardRect.width - 60;
      const maxY = boardRect.height - 60;
      
      const x = Math.floor(Math.random() * maxX);
      const y = Math.floor(Math.random() * maxY);
      
      itemElement.style.left = x + 'px';
      itemElement.style.top = y + 'px';
    }

    function handleGameKeyPress(e) {
      if (!gameState.isPlaying) {
        if (e.code === 'Space') {
          e.preventDefault();
          startGame();
        }
        return;
      }
      
      const gameBoard = document.getElementById('gameBoard');
      const boardRect = gameBoard.getBoundingClientRect();
      const maxX = boardRect.width - 60;
      const maxY = boardRect.height - 60;
      const moveDistance = 15;
      
      switch(e.code) {
        case 'ArrowUp':
        case 'KeyW':
          e.preventDefault();
          movePanda('up');
          break;
        case 'ArrowDown':
        case 'KeyS':
          e.preventDefault();
          movePanda('down');
          break;
        case 'ArrowLeft':
        case 'KeyA':
          e.preventDefault();
          movePanda('left');
          break;
        case 'ArrowRight':
        case 'KeyD':
          e.preventDefault();
          movePanda('right');
          break;
        case 'Space':
          e.preventDefault();
          if (!gameState.isPlaying) {
            startGame();
          }
          break;
      }
      
      // Check collision
      checkCollision();
    }

    function movePanda(direction) {
      if (!gameState.isPlaying) return;
      
      const gameBoard = document.getElementById('gameBoard');
      const boardRect = gameBoard.getBoundingClientRect();
      const maxX = boardRect.width - 60;
      const maxY = boardRect.height - 60;
      const moveDistance = 15;
      
      switch(direction) {
        case 'up':
          gameState.pandaY = Math.max(0, gameState.pandaY - moveDistance);
          break;
        case 'down':
          gameState.pandaY = Math.min(maxY, gameState.pandaY + moveDistance);
          break;
        case 'left':
          gameState.pandaX = Math.max(0, gameState.pandaX - moveDistance);
          break;
        case 'right':
          gameState.pandaX = Math.min(maxX, gameState.pandaX + moveDistance);
          break;
      }
      
      // Update panda position
      placePanda();
      
      // Check collision
      checkCollision();
    }

    function checkCollision() {
      const panda = document.getElementById('panda');
      const itemElement = document.getElementById('heart');
      
      const pandaRect = panda.getBoundingClientRect();
      const itemRect = itemElement.getBoundingClientRect();
      
      // Check if panda touches item
      if (pandaRect.left < itemRect.right &&
          pandaRect.right > itemRect.left &&
          pandaRect.top < itemRect.bottom &&
          pandaRect.bottom > itemRect.top) {
        
        // Collect item
        const itemData = gameState.currentItem.data;
        gameState.score += itemData.points;
        gameState.itemsCollected++;
        gameState.totalItems += itemData.points;
        
        // Update UI
        updateGameUI();
        
        // Create collection effect with item-specific animation
        createCollectionEffect(itemRect.left, itemRect.top, itemData);
        
        // Check level completion
        if (gameState.itemsCollected >= gameState.itemsNeeded) {
          completeLevel();
        } else {
          // Place new item
          placeItem();
        }
      }
    }

    function completeLevel() {
      gameState.isPlaying = false;
      
      // Update high score and level
      if (gameState.score > gameState.highScore) {
        gameState.highScore = gameState.score;
        localStorage.setItem('pandaGameHighScore', gameState.highScore);
      }
      
      // Advance to next level
      if (gameState.level < 10) {
        gameState.level++;
        gameState.currentLevel = gameState.level;
        localStorage.setItem('pandaCurrentLevel', gameState.currentLevel);
        
        // Show level complete modal
        showLevelCompleteModal();
      } else {
        // Game completed
        showGameCompleteModal();
      }
    }

    function showLevelCompleteModal() {
      const config = levelConfigs[gameState.level];
      const modal = document.createElement('div');
      modal.className = 'game-over-modal';
      modal.style.display = 'flex';
      modal.innerHTML = `
        <div class="game-over-content">
          <h2>ğŸ‰ Level ${gameState.level - 1} Complete! ğŸ‰</h2>
          <p style="font-size: 1.2rem; color: #666; margin-bottom: 20px;">
            ${config.title}
          </p>
          <div class="final-score" style="color: #ff6b9d; font-size: 1.5rem;">
            Items Collected: ${gameState.itemsCollected}/${gameState.itemsNeeded}
          </div>
          <p style="font-size: 1.1rem; color: #555; margin: 20px 0;">
            Ready for the next challenge? ğŸ’•
          </p>
          <button class="game-btn" onclick="this.parentElement.parentElement.remove(); startGame();" style="margin: 10px;">
            ğŸš€ Next Level
          </button>
          <button class="game-btn" onclick="this.parentElement.parentElement.remove(); resetGame();" style="background: #666; margin: 10px;">
            ğŸ  Main Menu
          </button>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function showGameCompleteModal() {
      const modal = document.createElement('div');
      modal.className = 'game-over-modal';
      modal.style.display = 'flex';
      modal.innerHTML = `
        <div class="game-over-content">
          <h2>ğŸ† Game Complete! ğŸ†</h2>
          <p style="font-size: 1.2rem; color: #666; margin-bottom: 20px;">
            You've mastered all levels of love! ğŸ’•
          </p>
          <div class="final-score" style="color: #ff6b9d; font-size: 1.5rem;">
            Total Points: ${gameState.totalItems}
          </div>
          <p style="font-size: 1.1rem; color: #555; margin: 20px 0;">
            You are a true love master! ğŸŒ¹
          </p>
          <button class="game-btn" onclick="this.parentElement.parentElement.remove(); resetGame();" style="margin: 10px;">
            ğŸ”„ Play Again
          </button>
          <button class="game-btn" onclick="this.parentElement.parentElement.remove();" style="background: #666; margin: 10px;">
            âŒ Close
          </button>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function createCollectionEffect(x, y, itemData) {
      const effect = document.createElement('div');
      effect.textContent = itemData.emoji;
      effect.style.position = 'fixed';
      effect.style.left = x + 'px';
      effect.style.top = y + 'px';
      effect.style.fontSize = '2.5rem';
      effect.style.color = itemData.color;
      effect.style.pointerEvents = 'none';
      effect.style.zIndex = '20';
      effect.style.animation = `collectionEffect${itemData.effect} 1.5s ease-out forwards`;
      effect.style.filter = 'drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.3))';
      
      document.body.appendChild(effect);
      
      // Create boom effects for anime items
      if (itemData.boom) {
        gameState.boomCount++;
        createBoomEffect(x, y, itemData);
      }
      
      // Create multiple effects for higher value items
      if (itemData.points >= 3) {
        for (let i = 0; i < 3; i++) {
          setTimeout(() => {
            const extraEffect = document.createElement('div');
            extraEffect.textContent = 'âœ¨';
            extraEffect.style.position = 'fixed';
            extraEffect.style.left = (x + Math.random() * 40 - 20) + 'px';
            extraEffect.style.top = (y + Math.random() * 40 - 20) + 'px';
            extraEffect.style.fontSize = '1.5rem';
            extraEffect.style.color = '#f1c40f';
            extraEffect.style.zIndex = '21';
            extraEffect.style.animation = 'sparkleEffect 1s ease-out forwards';
            extraEffect.style.pointerEvents = 'none';
            document.body.appendChild(extraEffect);
            
            setTimeout(() => extraEffect.remove(), 1000);
          }, i * 200);
        }
      }
      
      setTimeout(() => {
        effect.remove();
      }, 1500);
    }

    function createBoomEffect(x, y, itemData) {
      // Create explosion effect
      const boomEffect = document.createElement('div');
      boomEffect.textContent = 'ğŸ’¥';
      boomEffect.style.position = 'fixed';
      boomEffect.style.left = x + 'px';
      boomEffect.style.top = y + 'px';
      boomEffect.style.fontSize = '3rem';
      boomEffect.style.color = '#e74c3c';
      boomEffect.style.pointerEvents = 'none';
      boomEffect.style.zIndex = '22';
      boomEffect.style.animation = 'boomEffect 0.8s ease-out forwards';
      boomEffect.style.filter = 'drop-shadow(0 0 10px rgba(231, 76, 60, 0.8))';
      
      document.body.appendChild(boomEffect);
      
      // Create multiple explosion particles
      for (let i = 0; i < 8; i++) {
        setTimeout(() => {
          const particle = document.createElement('div');
          particle.textContent = 'ğŸ’¥';
          particle.style.position = 'fixed';
          particle.style.left = (x + Math.random() * 80 - 40) + 'px';
          particle.style.top = (y + Math.random() * 80 - 40) + 'px';
          particle.style.fontSize = '1.5rem';
          particle.style.color = '#f39c12';
          particle.style.zIndex = '23';
          particle.style.animation = 'boomParticle 1s ease-out forwards';
          particle.style.pointerEvents = 'none';
          document.body.appendChild(particle);
          
          setTimeout(() => particle.remove(), 1000);
        }, i * 50);
      }
      
      // Mega boom for epic items
      if (itemData.megaBoom) {
        setTimeout(() => {
          const megaBoom = document.createElement('div');
          megaBoom.textContent = 'ğŸ’¥ğŸ’¥ğŸ’¥';
          megaBoom.style.position = 'fixed';
          megaBoom.style.left = (x - 20) + 'px';
          megaBoom.style.top = (y - 20) + 'px';
          megaBoom.style.fontSize = '4rem';
          megaBoom.style.color = '#e67e22';
          megaBoom.style.pointerEvents = 'none';
          megaBoom.style.zIndex = '24';
          megaBoom.style.animation = 'megaBoomEffect 1.2s ease-out forwards';
          megaBoom.style.filter = 'drop-shadow(0 0 20px rgba(230, 126, 34, 1))';
          document.body.appendChild(megaBoom);
          
          setTimeout(() => megaBoom.remove(), 1200);
        }, 200);
      }
      
      setTimeout(() => {
        boomEffect.remove();
      }, 800);
    }

    function updateGameUI() {
      const config = levelConfigs[gameState.level] || levelConfigs[1];
      document.getElementById('score').textContent = `Level ${gameState.level}: ${gameState.itemsCollected}/${gameState.itemsNeeded} items`;
      document.getElementById('totalHearts').textContent = gameState.totalItems;
      
      // Update level title if element exists
      const levelTitle = document.getElementById('levelTitle');
      if (levelTitle) {
        levelTitle.textContent = config.title;
      }
    }

    function winGame() {
      gameState.isPlaying = false;
      gameState.gamesPlayed++;
      
      // Update high score
      if (gameState.score > gameState.highScore) {
        gameState.highScore = gameState.score;
        localStorage.setItem('pandaGameHighScore', gameState.highScore);
        document.getElementById('highScore').textContent = gameState.highScore;
      }
      
      // Save stats
      localStorage.setItem('pandaGamesPlayed', gameState.gamesPlayed);
      localStorage.setItem('pandaTotalHearts', gameState.totalHearts);
      document.getElementById('gamesPlayed').textContent = gameState.gamesPlayed;
      
      // Show win message
      showWinMessage();
    }

    function showWinMessage() {
      const winModal = document.createElement('div');
      winModal.style.position = 'fixed';
      winModal.style.top = '0';
      winModal.style.left = '0';
      winModal.style.width = '100%';
      winModal.style.height = '100%';
      winModal.style.background = 'rgba(0, 0, 0, 0.8)';
      winModal.style.display = 'flex';
      winModal.style.justifyContent = 'center';
      winModal.style.alignItems = 'center';
      winModal.style.zIndex = '2000';
      winModal.style.backdropFilter = 'blur(10px)';
      
      const winContent = document.createElement('div');
      winContent.style.background = 'linear-gradient(135deg, #fff5f5, #ffe8e8)';
      winContent.style.color = '#333';
      winContent.style.padding = '40px';
      winContent.style.borderRadius = '25px';
      winContent.style.textAlign = 'center';
      winContent.style.maxWidth = '500px';
      winContent.style.boxShadow = '0 25px 70px rgba(0, 0, 0, 0.3)';
      winContent.style.border = '3px solid var(--rose-pink)';
      
      winContent.innerHTML = `
        <h2 style="font-family: 'Great Vibes', cursive; font-size: 3rem; color: var(--rose-red); margin-bottom: 20px;">
          ğŸ‰ Panda Found True Love! ğŸ’•ğŸ¼
        </h2>
        <p style="font-size: 1.2rem; margin: 10px 0; color: #555;">
          Congratulations! The panda collected 10 hearts and found true love!
        </p>
        <div style="font-size: 2rem; font-weight: 700; color: var(--gold); margin: 20px 0;">
          ğŸ’– True Love Achieved! ğŸ’–
        </div>
        <p style="font-size: 1.1rem; color: #666; margin-bottom: 30px;">
          The panda's journey to find love is complete! â¤ï¸
        </p>
        <button class="game-btn" onclick="this.parentElement.parentElement.remove(); resetGame();" style="margin: 10px;">
          ğŸ”„ Play Again
        </button>
        <button class="game-btn" onclick="this.parentElement.parentElement.remove();" style="background: #666; margin: 10px;">
          âŒ Close
        </button>
      `;
      
      winModal.appendChild(winContent);
      document.body.appendChild(winModal);
    }

    // Add CSS animations for game effects
    const style = document.createElement('style');
    style.textContent = `
      @keyframes collectionEffect {
        0% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.5); opacity: 0.8; }
        100% { transform: scale(0.5) translateY(-50px); opacity: 0; }
      }
      
      @keyframes levelUpEffect {
        0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
        50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
        100% { transform: translate(-50%, -50%) scale(1) translateY(-30px); opacity: 0; }
      }
        `;
    document.head.appendChild(style);
    
